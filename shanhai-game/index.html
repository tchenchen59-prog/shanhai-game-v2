<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¼‚å…½æ‹“ç½— (V9.5 ä¼ è¯´å‰§æƒ…ç‰ˆ)</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <style>
  /* === â­ ç»ˆææ–¹æ¡ˆï¼šå…¨ç«™ç»Ÿä¸€ä½¿ç”¨ã€ç«™é…·å°è–‡ã€‘ === */

/* 1. æ ¸å¼¹çº§æŒ‡ä»¤ï¼šå¼ºåˆ¶æ¸¸æˆé‡Œã€æ‰€æœ‰ä¸œè¥¿ã€‘éƒ½å˜æˆç«™é…·å°è–‡å­—ä½“ */
* {
    font-family: 'ZCOOL XiaoWei', serif !important;
}

/* 2. æŒ‰é’®ä¸“ä¿®è¡¥ä¸ï¼šè§£å†³â€œæŒ‰é”®æ–‡å­—æ²¡å˜â€çš„é—®é¢˜
   (æŒ‰é’®é€šå¸¸å¾ˆé¡½å›ºï¼Œå¿…é¡»å•ç‹¬ç‚¹åå¼ºåˆ¶ä¿®æ”¹) */
button, input, .btn, .s-btn, .level-btn {
    font-family: 'ZCOOL XiaoWei', serif !important;
    font-weight: bold; /* åŠ ç²—ä¸€ç‚¹ï¼Œè®©æŒ‰é’®æ–‡å­—æ›´æ˜¾çœ¼ */
    letter-spacing: 2px; /* å­—é—´è·ç¨å¾®æ‹‰å¼€ï¼Œæ›´æœ‰é«˜çº§æ„Ÿ */
}

/* 3. æ•…äº‹é˜ä¿®æ­£ï¼šè§£å†³â€œæ•…äº‹é˜æœ‰ä¸¤ç§æ–‡å­—â€çš„é—®é¢˜
   (å¼ºåˆ¶æŠŠæ ‡é¢˜å’Œæ­£æ–‡éƒ½ç»Ÿä¸€ï¼Œé˜²æ­¢æ··ç”¨) */
.story-title, .story-text, .sv-right, .book-page {
    font-family: 'ZCOOL XiaoWei', serif !important;
}
/* === ç²˜è´´ç»“æŸ === */
    :root { 
        --teal-dark: #0f2027; --teal-mid: #203a43; --teal-light: #2c5364;
        --gold: #e6c88b; --gold-dark: #b88a4d;
        --red: #d64f4f; --blue: #5fa8d3; --purple: #b388eb; --green: #6aba84;
        --panel-bg: rgba(15, 32, 39, 0.95);
    }
/* 1. Body æ ·å¼ï¼šåªè´Ÿè´£æ¸…ç©ºè¾¹è·ï¼Œä¸åšèƒŒæ™¯å¤„ç†ï¼Œé˜²æ­¢å†²çª */
body { 
    margin: 0; 
    overflow: hidden; 
    background: #000; /* åº•è‰²é»‘è‰²ï¼Œé˜²æ­¢åŠ è½½é—ªçƒ */
    height: 100vh; 
    width: 100vw;
}

/* 2. æ–°å¢ï¼šä¸“é—¨çš„èƒŒæ™¯å±‚æ ·å¼ (ç»å¯¹ç¨³å›ºï¼Œä¸ä¼šè·‘å) */
#bg-layer {
    position: fixed; /* ğŸ”´ å¼ºåˆ¶å›ºå®šåœ¨çª—å£ï¼Œä¸å—ä»»ä½•å¹²æ‰° */
    top: 0; left: 0; 
    width: 100%; height: 100%;
    z-index: 0; /* æ”¾åœ¨æœ€åº•å±‚ */
    
    /* èƒŒæ™¯å›¾è®¾ç½® */
    background: url('bg_new.jpg') center center no-repeat;
    background-size: cover; /* é“ºæ»¡å…¨å± */
    
    /* âœ¨ æ¨¡ç³Šåº¦è°ƒæ•´ï¼š2px (æ¯”ä¹‹å‰çš„4pxæ›´æ¸…æ™°ï¼Œèƒ½çœ‹æ¸…äººç‰©ï¼Œä½†æœ‰æ™¯æ·±æ„Ÿ) */
    filter: blur(2px) brightness(0.6); 
    
    /* ç¨å¾®æ”¾å¤§ä¸€ç‚¹ç‚¹ï¼Œé˜²æ­¢æ¨¡ç³Šè¾¹ç¼˜æœ‰ç™½è¾¹ */
    transform: scale(1.02); 
}

/* 3. æ¸¸æˆå®¹å™¨æ ·å¼ï¼šç»å¯¹å±…ä¸­ */
#scale-wrapper { 
    width: 1920px; 
    height: 1080px; 
    
    /* â­ æ ¸å¿ƒå±…ä¸­ä»£ç  */
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%); /* è®©ä¸­å¿ƒç‚¹å¯¹å‡†å±å¹•ä¸­å¿ƒ */
    
    /* é…åˆ JS çš„ç¼©æ”¾é€»è¾‘ï¼Œè¿™é‡Œéœ€è¦ä¸€ç‚¹ç‰¹æ®Šå¤„ç† */
    transform-origin: center center; 
    
    z-index: 10; /* ä¿è¯åœ¨èƒŒæ™¯å±‚ä¸Šé¢ */
    box-shadow: 0 0 60px rgba(0,0,0,0.9); /* é»‘è‰²æŠ•å½±ï¼ŒæŠŠæ¸¸æˆä¸»ä½“æ‰˜èµ·æ¥ */
}
    #game-app { width: 100%; height: 100%; position: relative; background: #000; box-shadow: 0 0 100px #000; overflow: hidden; }
    
    .scene { position: absolute; top:0; left:0; width:100%; height:100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; pointer-events: auto; }
    #scene-menu { background: url('bg_new.jpg') center center no-repeat; background-size: cover; justify-content: flex-start !important; padding-top: 80px; background-color: #000; }
    
    /* æ ‡é¢˜æ ·å¼ */
    .main-title { 
        font-family: 'my_font', 'my_font', serif; font-size: 160px; margin: 0 0 30px 0; letter-spacing: 25px; 
        background: linear-gradient(to bottom, #fff 0%, #e6c88b 30%, #b88a4d 70%, #8a6e3e 100%); 
        -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        filter: drop-shadow(0 2px 0px #3e2723) drop-shadow(0 0 30px rgba(184, 138, 77, 0.6)); 
        position: relative; z-index: 2; 
    }
    .scene-dark { background: rgba(10, 12, 15, 0.96); }
    .hidden { display: none !important; }

    /* æŒ‰é’®æ ·å¼ */
    .menu-bar { position: absolute; bottom: 100px; left: 0; width: 100%; display: flex; justify-content: center; gap: 40px; z-index: 100; flex-wrap: wrap;}
    .btn { 
        position: relative; background: linear-gradient(to bottom, var(--teal-mid), var(--teal-dark)); 
        border: 2px solid var(--gold-dark); border-radius: 6px; 
        color: var(--gold); padding: 12px 40px; font-size: 26px; font-family: inherit; cursor: pointer; letter-spacing: 6px; 
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6), inset 0 0 15px rgba(44, 83, 100, 0.5);
        min-width: 240px; text-shadow: 0 2px 2px rgba(0,0,0,0.8);
    }
    .btn::before { content: ''; position: absolute; top: 4px; left: 4px; right: 4px; bottom: 4px; border: 1px solid rgba(230, 200, 139, 0.3); border-radius: 4px; pointer-events: none; }
    .btn:hover { background: linear-gradient(to bottom, var(--teal-light), var(--teal-mid)); color: #fff; border-color: var(--gold); transform: translateY(-3px); box-shadow: 0 0 25px rgba(230, 200, 139, 0.4), inset 0 0 10px rgba(230, 200, 139, 0.2); text-shadow: 0 0 10px var(--gold); }
    .btn:active { transform: translateY(1px); }

    /* ç½‘æ ¼å¸ƒå±€ */
    #grid-container, #gallery-grid, #story-list, #level-grid { display: grid; grid-template-columns: repeat(3, 280px); justify-content: center; gap: 50px; padding: 40px; max-height: 650px; overflow-y: auto; scroll-behavior: smooth; }
    ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 4px; } ::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 4px; }
    
    /* å¡ç‰Œæ ·å¼ */
    .card-box {
        position: relative; width: 100%; height: 380px; background: rgba(20, 35, 40, 0.85);
        border: 2px solid rgba(230, 200, 139, 0.2); border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.6); cursor: pointer; overflow: hidden;
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); display: flex; flex-direction: column;
    }
    .card-box:hover { transform: translateY(-10px); border-color: #fff; background: rgba(50,50,60,0.9); z-index: 5; }
    .card-box.picked { border-color: #fff !important; background: rgba(40, 60, 50, 0.95); box-shadow: 0 0 20px var(--gold); transform: translateY(-15px) scale(1.02); animation: cardPulse 2s infinite ease-in-out; }
    .card-box.picked .card-name-text { color: #fff !important; text-shadow: 0 0 5px #000, 0 0 15px var(--gold); transform: scale(1.1); letter-spacing: 5px; }
    .card-box.picked::after { content: 'å‡ºæˆ˜'; position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg); font-size: 90px; color: rgba(255, 255, 255, 0.15); border: 6px solid rgba(255, 255, 255, 0.15); border-radius: 50%; width: 160px; height: 160px; display: flex; justify-content: center; align-items: center; pointer-events: none; z-index: 0; }
    @keyframes cardPulse { 0% { box-shadow: 0 0 15px var(--gold); border-color: var(--gold); } 50% { box-shadow: 0 0 35px var(--gold), 0 0 10px #fff; border-color: #fff; } 100% { box-shadow: 0 0 15px var(--gold); border-color: var(--gold); } }

    .c-img { flex: 1; margin: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; background: #000; border-radius: 8px 8px 0 0; }
    .c-img img { width: 100%; height: 100%; object-fit: cover; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); transition: 0.3s; }
    .card-box:hover .c-img img { transform: scale(1.05); }
    .role-badge { position: absolute; top: 10px; right: 10px; padding: 4px 10px; font-size: 16px; color: #fff; border-radius: 4px; font-family: sans-serif; text-shadow: 1px 1px 0 #000; box-shadow: 0 2px 5px #000; z-index: 2;}
    .bg-red { background: rgba(255, 68, 68, 0.9); } .bg-blue { background: rgba(51, 204, 255, 0.9); } .bg-purple { background: rgba(170, 85, 255, 0.9); }

    /* æˆ˜æ–—åœºæ™¯åŸºç¡€ */
    #battle-scene { width: 100%; height: 100%; background: linear-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.25)), url('battle_bg.jpg') center/cover no-repeat; display: flex; flex-direction: column; position: relative; }
    .top-bar { height: 80px; flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; padding: 0 40px; background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent); }
    .field { flex: 1; display: flex; justify-content: center; align-items: center; gap: 150px; position: relative; margin-top: 60px; margin-bottom: 20px; }
    .unit { width: 320px; text-align: center; position: relative; filter: drop-shadow(0 0 20px rgba(0,0,0,0.5)); z-index: 20; }
    .avatar { width: 200px; height: 200px; border-radius: 50%; border: 4px solid rgba(255,255,255,0.8); margin: 0 auto; overflow: hidden; background: rgba(0,0,0,0.3); position: relative; z-index: 5; box-shadow: 0 0 40px rgba(0,0,0,0.5); transition: 0.3s; backdrop-filter: blur(5px); }
    .avatar img { width: 100%; height: 100%; object-fit: contain; transform: scale(0.9); }
    .unit.hit .avatar { border-color: #ff0000; filter: brightness(2) sepia(1) hue-rotate(-50deg) saturate(5); }
    .hp-bar { width: 100%; height: 14px; background: rgba(0,0,0,0.6); margin-top: 15px; border-radius: 7px; overflow: hidden; border: 1px solid rgba(255,255,255,0.3); }
    .hp-fill { height: 100%; transition: width 0.2s ease-out; }
    .hp-e { background: linear-gradient(90deg, #c0392b, #ff6b6b); } .hp-p { background: linear-gradient(90deg, #1098ad, #4dabf7); }
    .buffs { height: 30px; display: flex; justify-content: center; gap: 5px; margin-bottom: 5px; }
    .buff { padding: 2px 6px; border-radius: 4px; font-size: 13px; border: 1px solid; background: rgba(0,0,0,0.7); }

    /* æˆ˜æ–—è®°å½•ä¸å¡ç‰Œ */
    .mini-log { position: absolute; bottom: 30px; right: 30px; width: 350px; height: 250px; background: rgba(0, 0, 0, 0.7); border: 1px solid var(--gold); border-radius: 8px; display: flex; flex-direction: column; padding: 15px; backdrop-filter: blur(5px); z-index: 60; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
    .log-header { font-size: 18px; color: var(--gold); border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 5px; padding-bottom: 5px; }
    #log-content { flex: 1; overflow-y: auto; font-family: sans-serif; font-size: 14px; line-height: 1.6; }
    .log-item { margin-bottom: 4px; border-bottom: 1px dashed rgba(255,255,255,0.05); }
    .log-p { color: #8ce9ff; } .log-e { color: #ff8787; } .log-s { color: #ffd700; }

    #hand-zone { height: 450px; display: flex; justify-content: center; align-items: flex-end; gap: 25px; padding-bottom: 20px; }
  /* === æ‰¾åˆ° .card å¹¶æ›¿æ¢æˆä¸‹é¢è¿™æ · === */
.card { 
    width: 230px; height: 330px; 
    background: #000; 
    border: 1px solid rgba(255,255,255,0.3); 
    border-radius: 8px; 
    cursor: pointer; 
    position: relative; 
    transition: 0.2s; /* åŠ¨ç”»é€Ÿåº¦ */
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
    
    /* ğŸ”´ åˆ æ‰äº†åŸæœ¬è¿™é‡Œçš„ filter: grayscale(1) å’Œ pointer-events: none */
    /* ç°åœ¨é»˜è®¤å°±æ˜¯å½©è‰²ã€å¯ç‚¹å‡»çš„ */
}

/* ä¿æŒè¿™ä¸ªæ‚¬åœæ•ˆæœ */
.card:hover { transform: translateY(-20px); border-color: #fff; z-index: 50; }

/* é€‰ä¸­å¼¹å‡ºèœå•æ—¶çš„æ•ˆæœ */
.card.active { transform: translateY(-40px); border-color: var(--gold); box-shadow: 0 0 40px rgba(212, 175, 55, 0.4); z-index: 100; }

/* ğŸŸ¢ åªæœ‰è¡ŒåŠ¨è¿‡åï¼Œæ‰å˜ç° */
.card.acted {
    filter: grayscale(1) brightness(0.6);
    pointer-events: none; /* ç¦æ­¢å†æ¬¡è¡ŒåŠ¨ */
    transform: translateY(0) !important; /* å›åˆ°åŸä½ */
}
    .card .c-img { position: absolute; top:0; left:0; width:100%; height:100%; border-radius: 8px; overflow: hidden; z-index: 0; }
    .card .c-img img { width: 100%; height: 100%; object-fit: cover; }
    .card-mask { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.95) 10%, rgba(0,0,0,0) 100%); padding: 40px 10px 10px 10px; box-sizing: border-box; border-radius: 0 0 8px 8px; z-index: 1; display: flex; flex-direction: column; gap: 4px; }
    .mp-bar { width: 100%; height: 6px; background: rgba(255,255,255,0.2); border-radius: 3px; overflow: hidden; border:1px solid rgba(0,0,0,0.5); }
    .mp-val { height: 100%; background: #4dabf7; width: 0%; transition: 0.3s; box-shadow: 0 0 5px #4dabf7; }
    .xp-bar { width: 100%; height: 3px; background: rgba(255,255,255,0.2); border-radius: 2px; overflow: hidden; margin-top: 2px; }
    .xp-val { height: 100%; background: #69db7c; width: 0%; transition: 0.3s; }
    .card-level { position: absolute; top: 8px; right: 8px; background: var(--gold); color: #000; font-weight: bold; padding: 2px 6px; border-radius: 4px; box-shadow: 1px 1px 5px #000; z-index: 10; font-size: 14px; }
    
    .skill-menu { position: absolute; bottom: 100%; left: 0; width: 100%; background: rgba(10, 10, 15, 0.95); border: 1px solid var(--gold); border-bottom: none; backdrop-filter: blur(10px); display: none; flex-direction: column; padding: 5px; box-sizing: border-box; border-radius: 8px 8px 0 0; }
    .card.active .skill-menu { display: flex; animation: fadeUp 0.2s; }
    @keyframes fadeUp { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
    .s-btn { padding: 8px; margin-bottom: 2px; background: rgba(255,255,255,0.05); color: #ddd; cursor: pointer; display: flex; justify-content: space-between; font-size: 13px; border: 1px solid rgba(255,255,255,0.1); transition: 0.1s; border-radius: 4px; }
    .s-btn:hover { background: rgba(255,255,255,0.15); border-color: var(--gold); color: #fff; }
    .s-btn.ult { color: var(--gold); border-color: rgba(212, 175, 55, 0.5); font-weight: bold; }
    .s-btn.disabled { opacity: 0.3; pointer-events: none; filter: grayscale(1); }
    .skill-banner { position: absolute; top: -80px; left: 50%; transform: translateX(-50%); background: linear-gradient(90deg, transparent, rgba(0,0,0,0.8), transparent); border-top: 1px solid var(--gold); border-bottom: 1px solid var(--gold); color: #fff; padding: 5px 60px; font-size: 36px; font-weight: bold; white-space: nowrap; text-shadow: 0 0 10px var(--gold); opacity: 0; pointer-events: none; z-index: 200; font-family: 'my_font', serif; }
    .banner-anim { animation: bannerPop 1.5s forwards; }
    @keyframes bannerPop { 0%{opacity:0; transform:translate(-50%, 20px);} 10%{opacity:1; transform:translate(-50%, 0);} 80%{opacity:1; transform:translate(-50%, 0);} 100%{opacity:0; transform:translate(-50%, -20px);} }
    
    .tooltip { position: absolute; left: 105%; bottom: 0; width: 220px; background: rgba(0,0,0,0.95); border: 1px solid #666; padding: 10px; display: none; z-index: 300; text-align: left; pointer-events: none; font-size: 13px; line-height: 1.5; box-shadow: 5px 5px 15px #000; }
    .s-btn:hover .tooltip { display: block; }
    .shake-screen { animation: screenShake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes screenShake { 0% { transform: translate(0, 0); } 10% { transform: translate(-10px, -10px); } 20% { transform: translate(10px, 10px); } 30% { transform: translate(-10px, 10px); } 40% { transform: translate(10px, -10px); } 50% { transform: translate(-10px, 0); } 60% { transform: translate(10px, 0); } 100% { transform: translate(0, 0); } }
    
    .card-name-mask { position: absolute; bottom: 0; left: 0; width: 100%; height: 80px; background: linear-gradient(to top, rgba(0,0,0,0.95) 20%, transparent); display: flex; align-items: flex-end; justify-content: center; padding-bottom: 15px; border-radius: 0 0 8px 8px; z-index: 2; pointer-events: none; }
    .card-name-text { font-family: 'my_font', cursive; text-shadow: 0 2px 4px #000; }
    
    /* ç•Œé¢å¼¹çª— */
    .modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); z-index: 2000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
    .modal-box { background: var(--panel-bg); border: 2px solid var(--gold); padding: 40px; text-align: center; min-width: 400px; box-shadow: 0 0 50px rgba(0,0,0,0.8); border-radius: 12px; }
    .story-view { width: 1300px; height: 750px; background: var(--panel-bg); border: 2px solid var(--purple); box-shadow: 0 0 80px rgba(138, 43, 226, 0.2); border-radius: 12px; display: flex; overflow: hidden; position: relative; }
    .sv-left { width: 350px; flex-shrink: 0; border-right: 1px solid rgba(255,255,255,0.1); background: #000; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-bottom: 20px; position: relative; }
    .sv-left img { flex: 1; width: 100%; height: 0; object-fit: contain; padding: 20px; box-sizing: border-box; }
    .sv-name-overlay { position: relative; width: 100%; background: none; text-align: center; padding: 10px 0; pointer-events: auto; flex-shrink: 0; }
    #sv-name { font-size: 40px !important; color: var(--gold); margin: 0; line-height: 1.2; text-shadow: 0 2px 4px #000; }
    #sv-role { font-size: 18px !important; color: #aaa; margin-top: 5px; font-family: sans-serif; letter-spacing: 2px; }
    .sv-right { flex: 1; padding: 40px 50px; overflow-y: auto; font-family: 'my_font', cursive; cursor: zoom-in; transition: background 0.2s; }
    .sv-right:hover { background: rgba(255, 255, 255, 0.02); }
    .detail-view { display: flex; width: 1100px; height: 650px; background: var(--panel-bg); border: 2px solid var(--gold); border-radius: 12px; box-shadow: 0 0 60px rgba(0,0,0,0.8); overflow: hidden; position: relative; }
    .dv-img { width: 45%; height: 100%; background: #000; border-right: 1px solid var(--gold); display: flex; align-items: center; justify-content: center; }
    .dv-img img { width: 100%; height: 100%; object-fit: contain; padding: 10px; box-sizing: border-box; }
    .dv-info { flex: 1; padding: 40px; display: flex; flex-direction: column; justify-content: center; text-align: left; box-sizing: border-box; }
    
    /* æ‚é¡¹ UI */
    #settings-panel { position: absolute; top: 20px; right: 20px; z-index: 9999; background: rgba(0, 0, 0, 0.7); border: 1px solid var(--gold); border-radius: 12px; padding: 10px 15px; backdrop-filter: blur(5px); display: flex; flex-direction: column; gap: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    .setting-row { display: flex; align-items: center; gap: 10px; color: var(--gold); font-size: 16px; font-weight: bold; }
    input[type=range] { -webkit-appearance: none; width: 100px; height: 6px; background: rgba(255, 255, 255, 0.2); border-radius: 3px; outline: none; }
    input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; background: var(--gold); border-radius: 50%; cursor: pointer; box-shadow: 0 0 5px #000; transition: 0.2s; }
    input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); }
    .level-btn { background: rgba(30,30,40,0.8); border: 1px solid #555; padding: 20px; font-size: 24px; color: #aaa; cursor: pointer; transition: 0.2s; text-align: left; }
    .level-btn:hover { background: var(--gold); color: #000; border-color: #fff; transform: scale(1.05); }
    .level-btn div { font-size: 14px; margin-top: 5px; opacity: 0.7; }
    
    /* æ•…äº‹é˜ */
    .story-title { font-size: 28px; color: var(--gold); border-bottom: 1px solid rgba(255,255,255,0.2); margin: 40px 0 20px 0; padding-bottom: 10px; display: flex; align-items: center; justify-content: space-between; }
    .story-text { font-size: 18px; color: #ccc; line-height: 1.8; text-indent: 2em; margin-bottom: 20px; font-family: sans-serif; }
    .relation-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
    .relation-card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; display: flex; align-items: flex-start; gap: 15px; transition: 0.3s; cursor: pointer; }
    .rc-avatar { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #666; overflow: hidden; flex-shrink: 0; }
    .rc-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .rc-content { flex: 1; }
    .rc-name { color: var(--gold); font-size: 18px; margin-bottom: 5px; font-weight: bold; }
    .rc-text { color: #aaa; font-size: 14px; line-height: 1.4; font-family: sans-serif; }
    .voice-icon { cursor: pointer; font-size: 20px; color: var(--purple); transition: 0.2s; opacity: 0.7; margin-left: 10px; }
    .rc-section { margin-top: 8px; padding-top: 8px; border-top: 1px dashed rgba(255,255,255,0.1); }
    .rc-label { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; font-size: 14px; font-weight: bold; }
    .audio-btn { background: rgba(0, 0, 0, 0.4); border: 1px solid #555; color: var(--gold); padding: 2px 8px; border-radius: 4px; font-size: 12px; cursor: pointer; transition: 0.2s; display: inline-flex; align-items: center; gap: 4px; }

    /* ä¹¦é¡µé˜…è¯»æ¨¡å¼ */
    #book-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 5000; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; backdrop-filter: blur(5px); }
    #book-overlay.active { opacity: 1; pointer-events: auto; }
    .book-page { width: 900px; height: 90vh; background: #e8d0aa; background-image: linear-gradient(to right, rgba(0,0,0,0.05) 0%, transparent 5%, transparent 95%, rgba(0,0,0,0.05) 100%); box-shadow: 0 0 50px rgba(0,0,0,0.8), inset 0 0 30px rgba(139, 69, 19, 0.2); border-radius: 4px; padding: 60px 80px; box-sizing: border-box; overflow-y: auto; color: #3e2723; font-family: 'my_font', cursive; transform: scale(0.9); transition: transform 0.3s; }
    #book-overlay.active .book-page { transform: scale(1); }
    .book-page .story-title { color: #5d4037; border-bottom-color: #8d6e63; font-size: 36px; margin-top: 50px; }
    .book-page .story-text { color: #4e342e; font-size: 26px; line-height: 2; text-indent: 2em; }
    .book-close-hint { position: absolute; bottom: 30px; width: 100%; text-align: center; color: #888; font-size: 16px; font-family: sans-serif; pointer-events: none; }

    /* =========================================
       ã€æ–°ç‰ˆã€‘æˆ˜æ–—è§†è§‰ç³»ç»Ÿ (VFX / Action Bar / DMG)
       ========================================= */
    
    /* 1. åŠ¨æ€è¡ŒåŠ¨æ¡ (Action Bar) */
    #action-bar-container { position: absolute; top: 30px; left: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 800; pointer-events: none; }
    .ab-node { width: 65px; height: 65px; border-radius: 50%; border: 3px solid #333; background: #000; overflow: hidden; transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); position: relative; opacity: 0.7; transform: scale(0.9); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    .ab-node img { width: 100%; height: 100%; object-fit: cover; }
    .ab-node.active { border-color: #fff; transform: scale(1.3) translateX(25px); opacity: 1; z-index: 100; box-shadow: 0 0 25px var(--gold); }
    .ab-node.acted { filter: grayscale(1) brightness(0.5); opacity: 0.5; transform: scale(0.8); }

    /* =========================================
   â–¼â–¼â–¼ æ–°ç‰ˆï¼šé…·ç‚«ç‰¹æ•ˆä¸ä¼¤å®³æ•°å­—ç³»ç»Ÿ â–¼â–¼â–¼
   ========================================= */

/* =========================================
   â–¼â–¼â–¼ å…¨æ–°ç‰¹æ•ˆç³»ç»Ÿ (27ç§ç‹¬ç«‹æŠ€èƒ½ç‰¹æ•ˆ) â–¼â–¼â–¼
   ========================================= */

/* 1. ä¼¤å®³æ•°å­—ç³»ç»Ÿ */
.float-num { position: absolute; font-family: 'my_font', serif; font-weight: 900; pointer-events: none; z-index: 9999; text-shadow: 2px 2px 0 #000; transform: translate(-50%, -50%); white-space: nowrap; }
.dmg-normal { font-size: 60px; color: #fff; animation: numPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
.dmg-crit { font-size: 110px; color: #ffeb3b; background: linear-gradient(to bottom, #fff 30%, #ffcc00 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 10px #ff0000); animation: critExplode 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
.dmg-heal { font-size: 50px; color: #69db7c; animation: healFloat 1.0s ease-out forwards; }
@keyframes numPop { 0%{transform:translate(-50%,0) scale(0.5); opacity:0;} 50%{transform:translate(-50%,-60px) scale(1.2); opacity:1;} 100%{transform:translate(-50%,-80px) scale(1); opacity:0;} }
@keyframes critExplode { 0%{transform:translate(-50%,0) scale(0.5) rotate(-15deg); opacity:0;} 20%{transform:translate(-50%,-40px) scale(1.5) rotate(0deg); opacity:1;} 100%{transform:translate(-50%,-100px) scale(1); opacity:0;} }
@keyframes healFloat { 0%{transform:translate(-50%,0); opacity:0;} 100%{transform:translate(-50%,-100px); opacity:0;} }

/* 2. æŠ€èƒ½ç‰¹æ•ˆåŸºç¡€å®¹å™¨ */
.vfx-base { position: absolute; pointer-events: none; z-index: 8000; transform: translate(-50%, -50%); display: flex; align-items: center; justify-content: center; }

/* === è§’è‰²1ï¼šä¹å°¾ç‹ (ç«ç³») === */
/* æ™®æ”»ï¼šç‹ç«å¼¹ */
.vfx-fox-1 { width: 100px; height: 100px; background: radial-gradient(circle, #ff9800, transparent); border-radius: 50%; box-shadow: 0 0 20px #ff5722; animation: vfx-shoot 0.3s forwards; }
/* æˆ˜æŠ€ï¼šå¦–ç‹é¬¼è„¸ */
.vfx-fox-2 { width: 300px; height: 300px; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20,20 Q50,80 80,20 Q50,50 20,20" fill="%23ff0000" opacity="0.6"/></svg>'); filter: drop-shadow(0 0 10px red); animation: vfx-pop 0.5s ease-out; }
/* å¤§æ‹›ï¼šçº¢è²ä¸šç« (å…¨å±çˆ†ç‚¸) */
.vfx-fox-3 { width: 500px; height: 500px; background: radial-gradient(circle, #ff0000 20%, #ffeb3b 40%, transparent 70%); animation: vfx-explode 0.6s ease-out; mix-blend-mode: screen; }

/* === è§’è‰²2ï¼šé¥•é¤® (åå™¬) === */
/* æ™®æ”»ï¼šåˆ©é½¿ */
.vfx-tao-1 { width: 150px; height: 150px; border: 10px solid #fff; border-radius: 50%; border-top-color: transparent; animation: vfx-bite 0.3s linear; }
/* æˆ˜æŠ€ï¼šé»‘æ´ */
.vfx-tao-2 { width: 300px; height: 300px; background: #000; border-radius: 50%; box-shadow: 0 0 30px #ff5722; animation: vfx-implode 0.5s ease-in; }
/* å¤§æ‹›ï¼šæš´é£Ÿç››å®´ */
.vfx-tao-3 { width: 600px; height: 600px; background: radial-gradient(circle, #000 0%, #5d4037 80%, transparent 100%); animation: vfx-shake 0.5s; opacity: 0.8; }

/* === è§’è‰²3ï¼šç©·å¥‡ (é²œè¡€) === */
/* æ™®æ”»ï¼šè¡€çˆª */
.vfx-qiong-1 { width: 200px; height: 200px; background: linear-gradient(45deg, transparent 45%, #d32f2f 50%, transparent 55%); animation: vfx-slash 0.2s; }
/* æˆ˜æŠ€ï¼šè¡€çˆ† */
.vfx-qiong-2 { width: 300px; height: 300px; border: 5px solid #d32f2f; border-radius: 50%; animation: vfx-ripple 0.5s ease-out; }
/* å¤§æ‹›ï¼šææ¶æ–©å‡» (åå­—æ–©) */
.vfx-qiong-3 { width: 500px; height: 500px; }
.vfx-qiong-3::before, .vfx-qiong-3::after { content:''; position: absolute; width:100%; height:20px; background:#f00; box-shadow:0 0 20px #f00; top:50%; left:0; }
.vfx-qiong-3::before { transform: rotate(45deg); animation: vfx-slash 0.3s; }
.vfx-qiong-3::after { transform: rotate(-45deg); animation: vfx-slash 0.3s 0.1s; }

/* === è§’è‰²4ï¼šæœæœ (æ˜Ÿè¾°) === */
/* æ™®æ”»ï¼šæ˜Ÿå±‘ */
.vfx-fei-1::after { content:'âœ¨'; font-size: 80px; animation: vfx-spin-fade 0.5s; }
/* æˆ˜æŠ€ï¼šå¿˜å¿§å…‰ç¯ */
.vfx-fei-2 { width: 300px; height: 300px; border: 2px dashed #e040fb; border-radius: 50%; animation: vfx-spin-slow 2s linear infinite; }
/* å¤§æ‹›ï¼šæä¹å‡€åœŸ */
.vfx-fei-3 { width: 100%; height: 100%; background: radial-gradient(circle, rgba(224, 64, 251, 0.5) 0%, transparent 70%); animation: vfx-pulse 1s; }

/* === è§’è‰²5ï¼šè€³é¼  (æ¯’ç³») === */
/* æ™®æ”»ï¼šæ¯’é’ˆ */
.vfx-shu-1 { width: 100px; height: 10px; background: #aa00ff; border-radius: 5px; animation: vfx-shoot 0.2s; }
/* æˆ˜æŠ€ï¼šæ¯’é›¾ */
.vfx-shu-2 { width: 250px; height: 250px; background: radial-gradient(circle, #aa00ff 0%, transparent 70%); opacity: 0.6; filter: blur(20px); animation: vfx-float-up 1s; }
/* å¤§æ‹›ï¼šä¸‡æ¯’çˆ†å‘ */
.vfx-shu-3 { width: 400px; height: 400px; background: repeating-conic-gradient(#aa00ff 0% 10%, transparent 10% 20%); animation: vfx-spin 0.5s linear; border-radius: 50%; }

/* === è§’è‰²6ï¼šè ƒé±¼ (æ°´ç³») === */
/* æ™®æ”»ï¼šæ°´å¼¹ */
.vfx-yu-1 { width: 80px; height: 80px; background: #03a9f4; border-radius: 50%; box-shadow: 0 0 10px #fff; animation: vfx-shoot 0.3s; }
/* æˆ˜æŠ€ï¼šæ³¢æ¶› */
.vfx-yu-2 { width: 300px; height: 100px; border-top: 10px solid #03a9f4; border-radius: 50%; animation: vfx-wave 0.5s; }
/* å¤§æ‹›ï¼šæµ·å•¸ */
.vfx-yu-3 { width: 600px; height: 600px; border: 50px solid #0288d1; border-radius: 50%; animation: vfx-ripple 0.8s ease-out; opacity: 0.8; }

/* === è§’è‰²7ï¼šç™½æ³½ (å†°/å…‰) === */
/* æ™®æ”»ï¼šå†°æ£± */
.vfx-bai-1 { width: 20px; height: 100px; background: #fff; box-shadow: 0 0 10px #29b6f6; animation: vfx-stab 0.2s; }
/* æˆ˜æŠ€ï¼šå…«å¦ç›¾ */
.vfx-bai-2 { width: 250px; height: 250px; border: 5px solid #29b6f6; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); animation: vfx-pop 0.5s; }
/* å¤§æ‹›ï¼šå¤©é“é‡‘å…‰ */
.vfx-bai-3 { width: 100px; height: 1000px; background: #fff; box-shadow: 0 0 50px #29b6f6; animation: vfx-beam 0.4s; }

/* === è§’è‰²8ï¼šä¹˜é»„ (è‡ªç„¶) === */
/* æ™®æ”»ï¼šé£å¶ */
.vfx-cheng-1::after { content:'ğŸƒ'; font-size: 60px; animation: vfx-shoot 0.4s; }
/* æˆ˜æŠ€ï¼šç”Ÿæœº */
.vfx-cheng-2 { width: 200px; height: 200px; background: #66bb6a; border-radius: 50%; opacity: 0.5; animation: vfx-pulse 0.8s; }
/* å¤§æ‹›ï¼šå¤æ ‘é™ä¸´ */
.vfx-cheng-3 { font-size: 300px; color: #4caf50; animation: vfx-grow 1s; }
.vfx-cheng-3::after { content: 'ğŸŒ³'; }

/* === è§’è‰²9ï¼šé’é¸Ÿ (é£) === */
/* æ™®æ”»ï¼šé£åˆƒ */
.vfx-qing-1 { width: 150px; height: 50px; border-bottom: 5px solid #fff; border-radius: 50%; transform: rotate(-45deg); animation: vfx-slash 0.2s; }
/* æˆ˜æŠ€ï¼šä¿¡é£ */
.vfx-qing-2 { width: 300px; height: 300px; border: 2px dashed #fff; border-radius: 50%; animation: vfx-spin 0.5s; }
/* å¤§æ‹›ï¼šæ‰¶æ‘‡ç›´ä¸Š */
.vfx-qing-3 { width: 100%; height: 100%; background: linear-gradient(to top, #26c6da, transparent); animation: vfx-float-up 0.5s; opacity: 0.5; }

/* åŠ¨ç”»å…³é”®å¸§åº“ */
@keyframes vfx-shoot { 0%{transform:translate(-200%, -50%) scale(0.5); opacity:0;} 50%{opacity:1;} 100%{transform:translate(50%, -50%) scale(1); opacity:0;} }
@keyframes vfx-pop { 0%{transform:translate(-50%, -50%) scale(0);} 70%{transform:translate(-50%, -50%) scale(1.2);} 100%{transform:translate(-50%, -50%) scale(1); opacity:0;} }
@keyframes vfx-explode { 0%{transform:translate(-50%, -50%) scale(0.1); opacity:1;} 100%{transform:translate(-50%, -50%) scale(2); opacity:0;} }
@keyframes vfx-bite { 0%{transform:translate(-50%, -80%) scale(1.5) rotate(45deg); opacity:0;} 50%{transform:translate(-50%, -50%) scale(1) rotate(0deg); opacity:1;} 100%{opacity:0;} }
@keyframes vfx-implode { 0%{transform:translate(-50%, -50%) scale(2); opacity:0;} 50%{transform:translate(-50%, -50%) scale(1); opacity:1;} 100%{transform:translate(-50%, -50%) scale(0); opacity:1;} }
@keyframes vfx-slash { 0%{transform:translate(-50%, -50%) scale(0.5) rotate(-45deg); opacity:0;} 50%{opacity:1;} 100%{transform:translate(50%, 50%) scale(1.5) rotate(-45deg); opacity:0;} }
@keyframes vfx-ripple { 0%{width:0; height:0; opacity:1; border-width:20px;} 100%{width:500px; height:500px; opacity:0; border-width:0;} }
@keyframes vfx-spin { 0%{transform:translate(-50%, -50%) rotate(0deg);} 100%{transform:translate(-50%, -50%) rotate(360deg);} }
@keyframes vfx-spin-slow { 0%{transform:translate(-50%, -50%) rotate(0deg);} 100%{transform:translate(-50%, -50%) rotate(360deg);} }
@keyframes vfx-spin-fade { 0%{transform:translate(-50%, -50%) rotate(0deg) scale(0);} 50%{opacity:1;} 100%{transform:translate(-50%, -50%) rotate(180deg) scale(1.5); opacity:0;} }
@keyframes vfx-float-up { 0%{transform:translate(-50%, 0); opacity:0;} 50%{opacity:0.8;} 100%{transform:translate(-50%, -150px); opacity:0;} }
@keyframes vfx-beam { 0%{transform:translate(-50%, -100%) scaleY(0); opacity:1;} 50%{transform:translate(-50%, -50%) scaleY(1);} 100%{transform:translate(-50%, 0) scaleY(0); opacity:0;} }
@keyframes vfx-wave { 0%{transform:translate(-50%, 50%) scaleX(0);} 50%{transform:translate(-50%, -50%) scaleX(1);} 100%{transform:translate(-50%, -100%) scaleX(2); opacity:0;} }
@keyframes vfx-grow { 0%{transform:translate(-50%, 50%) scale(0);} 100%{transform:translate(-50%, -50%) scale(1); opacity:0;} }
@keyframes vfx-pulse { 0%{transform:translate(-50%, -50%) scale(0.8); opacity:0.5;} 50%{transform:translate(-50%, -50%) scale(1.2); opacity:1;} 100%{transform:translate(-50%, -50%) scale(1); opacity:0;} }
    .sp-dot { width: 20px; height: 20px; border-radius: 50%; border: 2px solid var(--gold); background: transparent; transition: 0.3s; box-shadow: 0 0 10px #000; }
    .sp-dot.active { background: var(--gold); box-shadow: 0 0 15px var(--gold); }
    #ult-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.92); z-index: 150; pointer-events: none; opacity: 0; transition: opacity 0.3s ease; }
    #vfx-screen { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events: none; z-index: 100; opacity: 0; transition: opacity 0.2s; mix-blend-mode: screen; }
    .ult-shake { animation: ultShakeAnim 0.6s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes ultShakeAnim { 0%, 100% { transform: translate(0, 0); } 10%, 30%, 50%, 70%, 90% { transform: translate(-15px, -15px) scale(1.02); } 20%, 40%, 60%, 80% { transform: translate(15px, 15px) scale(1.02); } }
    .card-evolving { animation: evolveAnim 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards; z-index: 999 !important; }
    @keyframes evolveAnim { 0% { transform: scale(1) rotate(0deg); filter: brightness(1); } 40% { transform: scale(1.2) rotate(5deg); filter: brightness(2) contrast(1.5); box-shadow: 0 0 50px var(--gold); } 50% { transform: scale(1.2) rotate(-5deg); opacity: 0; } 51% { opacity: 1; filter: brightness(1); } 100% { transform: scale(1) rotate(0deg); } }
    .evolve-beam { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100px; height: 0%; background: linear-gradient(to top, var(--gold), transparent); animation: beamUp 1s ease-out forwards; pointer-events: none; z-index: 900; }
    @keyframes beamUp { 0%{height:0%; opacity:1;} 50%{height:150%; opacity:1;} 100%{height:200%; opacity:0;} }
    .evo-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 60px; color: var(--gold); font-weight: bold; text-shadow: 0 0 20px #000; opacity: 0; z-index: 1000; pointer-events: none; animation: evoTextPop 1s ease-out forwards; }
    @keyframes evoTextPop { 0%{transform:translate(-50%,-50%) scale(0);} 50%{transform:translate(-50%,-50%) scale(1.5); opacity:1;} 100%{transform:translate(-50%,-100%) scale(2); opacity:0;} }
/* =========================================
   â–¼â–¼â–¼ ç²˜è´´åˆ° style æ ‡ç­¾çš„æœ€æœ«å°¾ â–¼â–¼â–¼
   ========================================= */

/* 1. å‡çº§ç‰ˆï¼šè¡ŒåŠ¨æ¡ (æ›´å¤§ã€æ›´é ä¸‹ã€æ›´æ˜¾çœ¼) */
#action-bar-container {
    position: absolute; 
    top: 220px;  /* ğŸ”» è¿™é‡Œæ§åˆ¶é«˜åº¦ï¼šæ•°å­—è¶Šå¤§è¶Šå¾€ä¸‹ */
    left: 30px; 
    display: flex; 
    flex-direction: column; 
    gap: 30px;   /* å¤´åƒä¹‹é—´çš„è·ç¦» */
    z-index: 800; 
    pointer-events: none;
}

/* æ¯ä¸€ä¸ªå°åœ†åœˆ */
.ab-node {
    width: 100px; height: 100px; /* ğŸ”´ å°ºå¯¸å˜å¤§ */
    border-radius: 50%;
    border: 3px solid #666; 
    background: #000;
    overflow: hidden; 
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative; 
    opacity: 0.5;            /* å¹³æ—¶åŠé€æ˜ */
    transform: scale(0.9);   /* å¹³æ—¶ç¨å¾®ç¼©å° */
    box-shadow: 0 5px 15px rgba(0,0,0,0.8);
}

.ab-node img { 
    width: 100%; height: 100%; 
    object-fit: cover; 
    filter: grayscale(1) brightness(0.7); /* å¹³æ—¶æ˜¯é»‘ç™½çš„ */
}

/* ğŸ”¥ å½“å‰æ­£åœ¨è¡ŒåŠ¨çš„è§’è‰² (é«˜äº®ç‰¹æ•ˆ) */
.ab-node.active {
    border-color: #fff;
    transform: scale(1.3) translateX(40px); /* ğŸŒŸ æ˜æ˜¾æ”¾å¤§å¹¶å‘å³å¼¹å‡º */
    opacity: 1; 
    z-index: 100;
    box-shadow: 0 0 30px var(--gold), 0 0 10px #fff; /* é‡‘è‰²å…‰è¾‰ */
}

.ab-node.active img {
    filter: grayscale(0) brightness(1.2); /* æ¢å¤å½©è‰²å¹¶å˜äº® */
}

/* å¢åŠ ä¸€ä¸ª"å½“å‰"çš„å°æ ‡ç­¾ */
.ab-node.active::after {
    content: 'Current'; 
    position: absolute; bottom: 5px; left: 0; width: 100%;
    font-size: 14px; color: var(--gold); font-weight: bold;
    text-align: center; text-shadow: 0 1px 2px #000;
}

/* 2. å‡çº§ç‰ˆï¼šå¡ç‰Œäº¤äº’ (å¹³æ—¶ç°ï¼Œè½®åˆ°æ‰äº®) */
#hand-zone { 
    height: 450px; 
    display: flex; justify-content: center; align-items: flex-end; 
    gap: 20px; padding-bottom: 20px; 
}

.card { 
    width: 230px; height: 330px; 
    background: #000; 
    border: 1px solid rgba(255,255,255,0.3); 
    border-radius: 8px; 
    position: relative; 
    transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
    
    /* ğŸŒ‘ é»˜è®¤çŠ¶æ€ï¼šç°è‰²ã€å‹æš—ã€ä¸å¯ç‚¹å‡» */
    filter: grayscale(1) brightness(0.4);
    transform: scale(0.95) translateY(20px); /* ç¼©ä¸‹å»ä¸€ç‚¹ */
    pointer-events: none; /* ğŸš« ç¦æ­¢ç‚¹å‡» */
}

/* ğŸŒŸ è½®åˆ°è¯¥è§’è‰²ï¼šæ¿€æ´»çŠ¶æ€ */
.card.my-turn {
    filter: grayscale(0) brightness(1.1); /* âœ¨ æ¢å¤å½©è‰² */
    transform: scale(1.1) translateY(-40px); /* âœ¨ è·³å‡ºæ¥ */
    border-color: var(--gold);
    box-shadow: 0 0 50px rgba(230, 200, 139, 0.5); /* é‡‘è‰²å…‰æ™• */
    z-index: 50;
    pointer-events: auto; /* âœ… å…è®¸ç‚¹å‡» */
    cursor: pointer;
}

/* é€‰ä¸­å¼¹å‡ºæŠ€èƒ½èœå•æ—¶ */
.card.my-turn.active {
    transform: scale(1.15) translateY(-60px); /* å†é«˜ä¸€ç‚¹ */
    z-index: 100;
    box-shadow: 0 0 80px rgba(230, 200, 139, 0.8);
}
/* === æ–°å¢ï¼šæŠ€èƒ½æŒ‰é’®ä¸å¯ç”¨çŠ¶æ€ === */
.s-btn.disabled {
    opacity: 0.4;             /* å˜åŠé€æ˜ */
    filter: grayscale(100%);  /* å˜é»‘ç™½ */
    pointer-events: none;     /* ç¦æ­¢ç‚¹å‡» */
    cursor: not-allowed;
    background: rgba(0,0,0,0.5);
    border-color: #333;
    color: #888;
}

/* ç®€å•çš„BOSSè¯´è¯æ°”æ³¡ (å¯é€‰å¢å¼º) */
.boss-bubble {
    position: absolute; top: -60px; right: 50%; 
    background: #fff; color: #000; padding: 10px 20px;
    border-radius: 20px; font-weight: bold; z-index: 100;
    opacity: 0; transition: opacity 0.3s; pointer-events: none;
    box-shadow: 0 0 10px rgba(255,0,0,0.5);
    white-space: nowrap;
}
.boss-bubble.show { opacity: 1; transform: translateY(-10px); }
/* === ä¿®å¤æ•…äº‹æ–‡æœ¬ç¼©è¿› === */
.story-text, .book-page .story-text {
    text-indent: 0 !important; /* å¼ºåˆ¶å–æ¶ˆé¦–è¡Œç¼©è¿› */
    text-align: justify;       /* è®©æ–‡å­—ä¸¤ç«¯å¯¹é½ï¼Œæ›´å¥½çœ‹ */
    padding-left: 5px;         /* ç¨å¾®ç•™ä¸€ç‚¹ç‚¹å·¦è¾¹è·ï¼Œä¸è‡³äºè´´ç€è¾¹ */
}
/* =========================================
   â–¼â–¼â–¼ UI ç¾åŒ–å¤§ç¤¼åŒ… (å›¾é‰´ & æ•…äº‹é˜) â–¼â–¼â–¼
   ========================================= */

/* 1. ç¾åŒ–å·¦ä¾§å›¾ç‰‡å®¹å™¨ (é€šç”¨) */
.sv-left, .dv-img {
    /* ğŸ”´ æ›¿æ¢æ‰åŸæ¥çš„çº¯é»‘èƒŒæ™¯ï¼Œæ”¹ç”¨é«˜çº§çš„è“é‡‘æ¸å˜é»‘ */
    background: radial-gradient(circle at center, #1a2a33 0%, #05080a 100%) !important;
    border-right: 1px solid rgba(230, 200, 139, 0.1) !important; /* è¾¹æ¡†å˜æ·¡ */
    position: relative;
    box-shadow: inset 0 0 50px rgba(0,0,0,0.8); /* å†…é˜´å½±ï¼Œå¢åŠ æ·±é‚ƒæ„Ÿ */
}

/* 2. ç»™å±•ç¤ºçš„å›¾ç‰‡åŠ ä¸€ç‚¹å…‰æ™•ï¼Œè®©å®ƒçœ‹èµ·æ¥åƒæ‚¬æµ®çš„ */
.sv-left img, .dv-img img {
    filter: drop-shadow(0 0 15px rgba(0,0,0,0.8));
    transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.sv-left img:hover, .dv-img img:hover {
    transform: scale(1.05); /* é¼ æ ‡æ”¾ä¸Šå»ä¼šç¨å¾®æ”¾å¤§ */
}

/* 3. èƒŒæ™¯è£…é¥°æ–‡å­— (å¯é€‰ï¼šå¢åŠ ä¸€ç‚¹å›½é£çº¹ç†æ„Ÿ) */
.sv-left::before, .dv-img::before {
    content: 'å±±æµ·';
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-family: 'my_font', 'my_font', serif;
    font-size: 200px;
    color: rgba(255, 255, 255, 0.03); /* ææ·¡çš„èƒŒæ™¯å­— */
    pointer-events: none;
    z-index: 0;
}

/* 4. ä¼˜åŒ–å³ä¾§æ–‡å­—åŒºçš„æ»šåŠ¨æ¡ */
.sv-right::-webkit-scrollbar, .dv-info::-webkit-scrollbar {
    width: 6px;
}
.sv-right::-webkit-scrollbar-thumb, .dv-info::-webkit-scrollbar-thumb {
    background: rgba(230, 200, 139, 0.3);
    border-radius: 3px;
}

/* 5. ä¼˜åŒ–åå­—æ˜¾ç¤ºçš„èƒŒæ™¯ */
.sv-name-overlay {
    background: linear-gradient(to top, rgba(0,0,0,0.8), transparent) !important;
    padding-bottom: 30px !important;
    width: 100%;
}

/* ==========================================================
   â–¼â–¼â–¼ ç»ˆæä¿®æ­£ï¼šå·¦ä¾§å¡ç‰Œå®Œç¾å±•ç¤º (æ— é®æŒ¡ç‰ˆ) â–¼â–¼â–¼
   ========================================================== */

/* ==========================================================
   â–¼â–¼â–¼ æ•…äº‹é˜å·¦ä¾§å¡ç‰Œç¾åŒ– (æ‚¬æµ®æ–‡å­—ç‰ˆ) â–¼â–¼â–¼
   ç›´æ¥ç²˜è´´åˆ° style æ ‡ç­¾æœ€æœ«å°¾
   ========================================================== */

/* 1. å·¦ä¾§å®¹å™¨ï¼šä½œä¸ºå®šä½çš„åŸºå‡† */
.sv-left {
    position: relative !important; /* å…³é”®ï¼šè®©é‡Œé¢çš„ç»å¯¹å®šä½ä»¥æˆ‘ä¸ºå‡† */
    width: 350px !important;       /* ä¿æŒå®½åº¦ */
    background: #000 !important;   /* åº•è‰²çº¯é»‘ï¼Œé˜²æ­¢å›¾ç‰‡åŠ è½½æ…¢æ—¶é€å‡ºåº•è‰² */
    overflow: hidden !important;   /* åˆ‡æ‰åœ†è§’å¤šä½™éƒ¨åˆ† */
    border-right: 1px solid rgba(255,255,255,0.1) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

/* 2. å¡ç‰Œå›¾ç‰‡ï¼šæ’‘æ»¡å®¹å™¨ï¼Œæ‹’ç»é»‘è¾¹ */
.sv-left img {
    width: 100% !important;
    height: 100% !important;
    /* ğŸ”´ é‡ç‚¹ï¼š
       cover = å¡«æ»¡æ•´ä¸ªåŒºåŸŸï¼Œæ²¡æœ‰é»‘è¾¹ï¼Œä½†å¯èƒ½ä¼šè£æ‰ä¸€ç‚¹ä¸Šä¸‹è¾¹ç¼˜ï¼ˆæ¨èï¼Œæœ€ç¾è§‚ï¼‰
       contain = å®Œæ•´æ˜¾ç¤ºå¡ç‰Œï¼Œä½†ä¸Šä¸‹ä¼šæœ‰é»‘è¾¹ï¼ˆå¦‚æœä½ ä¸€å®šè¦çœ‹å…¨è¾¹æ¡†ï¼Œå°±æ”¹æˆ containï¼‰
    */
    object-fit: cover !important; 
    padding: 0 !important; /* å»æ‰åŸæœ¬çš„å†…è¾¹è· */
    filter: brightness(0.9); /* ç¨å¾®å‹æš—ä¸€ç‚¹ç‚¹ï¼Œæ›´æœ‰è´¨æ„Ÿ */
    transition: transform 0.5s;
}

.sv-left:hover img {
    transform: scale(1.05); /* é¼ æ ‡æ‚¬åœå¾®æ”¾å¤§ */
    filter: brightness(1);
}

/* 3. åå­—æµ®å±‚ï¼šå˜æˆåº•éƒ¨çš„æ¸å˜è’™ç‰ˆ */
.sv-name-overlay {
    position: absolute !important; /* ç»å¯¹å®šä½ï¼šæµ®èµ·æ¥ */
    bottom: 0 !important;          /* ç´§è´´åº•éƒ¨ */
    left: 0 !important;
    width: 100% !important;
    height: auto !important;       /* é«˜åº¦è‡ªåŠ¨ */
    
    /* èƒŒæ™¯ï¼šä»é€æ˜åˆ°é»‘è‰²çš„æ¸å˜ï¼Œä¸å†æ˜¯ç”Ÿç¡¬çš„é»‘å— */
    background: linear-gradient(to top, rgba(0,0,0,0.95) 10%, rgba(0,0,0,0.6) 50%, transparent 100%) !important;
    
    padding: 60px 10px 20px 10px !important; /* ä¸Šé¢çš„ padding å¤§ä¸€ç‚¹ï¼Œä¸ºäº†æ¸å˜è¿‡æ¸¡è‡ªç„¶ */
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: flex-end !important;
    z-index: 10 !important;
    pointer-events: none !important; /* é¼ æ ‡ç©¿é€ï¼Œä¸å½±å“ç‚¹å›¾ç‰‡ */
}

/* 4. åå­—æ–‡å­—è°ƒæ•´ */
#sv-name {
    margin: 0 !important;
    font-size: 56px !important; /* å­—ä½“åŠ å¤§ */
    color: var(--gold) !important;
    font-family: 'my_font', 'my_font', cursive !important; /* ç¡®ä¿ç”¨ä¹¦æ³•ä½“ */
    text-shadow: 0 2px 8px rgba(0,0,0,1), 0 0 20px rgba(0,0,0,0.8) !important; /* å¼ºé˜´å½±ï¼Œé˜²æ­¢èƒŒæ™¯å¤ªäº®çœ‹ä¸æ¸… */
    line-height: 1.1 !important;
    transform: translateY(5px); /* ç¨å¾®å¾€ä¸‹å‹ä¸€ç‚¹ */
}

/* 5. ç§°å·/æè¿°æ–‡å­—è°ƒæ•´ */
#sv-role {
    margin-top: 5px !important;
    font-size: 16px !important;
    color: rgba(255, 255, 255, 0.7) !important;
    font-weight: normal !important;
    letter-spacing: 6px !important; /* å­—é—´è·æ‹‰å¤§ï¼Œæ›´æœ‰é«˜çº§æ„Ÿ */
    text-shadow: 0 1px 2px #000 !important;
    text-transform: uppercase;
}
/* å¼ºåˆ¶æ‰€æœ‰æŒ‰é’®å’Œè¾“å…¥æ¡†ä¹Ÿç”¨è¿™ä¸ªå­—ä½“ */
button, input, .btn {
    font-family: 'my_font', serif !important;
}
</style>
</head>
<body>
<div id="bg-layer"></div>

<div id="scale-wrapper">
    <div id="game-app">
        <audio id="bgm-player" src="bgm.mp3" loop></audio>
        <audio id="se-click" src="click.mp3" preload="auto"></audio>    
        <div id="settings-panel">
            <div class="setting-row"><span>ğŸµ éŸ³ä¹</span><input type="range" min="0" max="1" step="0.1" value="0.4" oninput="setMusicVol(this.value)"></div>
            <div class="setting-row"><span>ğŸ”Š è¯­éŸ³</span><input type="range" min="0" max="1" step="0.1" value="0.8" oninput="setVoiceVol(this.value)"></div>
        </div>

        <div id="ult-overlay"></div>
        <div id="ult-flash"></div>
        <div id="vfx-screen"></div> 
        
        <div id="scene-menu" class="scene">
            <h1 class="main-title">å¼‚å…½æ‹“ç½—</h1>
            <div id="save-msg" style="color:#ddd; font-size: 20px; text-shadow: 2px 2px 4px #000; margin-top: 10px;" class="hidden">å½“å‰è¿›åº¦ï¼šç¬¬ <span id="save-lvl" style="color:#fff; font-weight:bold;"></span> å±‚</div>
            
            <div class="menu-bar">
                <button class="btn" onclick="Game.toModes()">è¸å…¥æ´ªè’</button>
                
                <button class="btn" onclick="Game.toGallery()">ä¸‡å…½å›¾é‰´</button>
                
                <button class="btn" onclick="Game.toStory()">æ•…äº‹é˜</button>
            </div>
        </div>

        <div id="scene-modes" class="scene hidden scene-dark">
            <h2 style="color:var(--gold); font-size: 40px; margin-bottom: 40px; text-shadow: 0 0 10px #000;">é€‰æ‹©å¾ç¨‹</h2>
            
            <div style="display:flex; flex-direction:column; gap:25px; align-items:center;">
                <button class="btn" onclick="Game.loadRun()">ç»§ç»­å†ç»ƒ</button>
                
                <button class="btn" onclick="Game.toDeck()">å¼€å§‹å¾ç¨‹</button>
                
                <button class="btn" onclick="Game.toLevels()">è¯•ç‚¼é€‰æ‹©</button>
                
                <button class="btn" onclick="Game.toMenu()" style="margin-top:20px; border-color: rgba(255,255,255,0.2); color: #888;">è¿”å›</button>
            </div>
        </div>

        <div id="scene-levels" class="scene hidden scene-dark">
            <h2 style="color:var(--gold); font-size: 40px;">é€‰æ‹©è¯•ç‚¼å…³å¡</h2>
            <div id="level-grid">
                </div>
            <button class="btn" onclick="Game.toMenu()" style="margin-top: 20px;">è¿”å›</button>
        </div>

        <div id="scene-deck" class="scene hidden scene-dark">
            <h2 style="color:var(--gold); font-size:40px; margin-bottom:30px; text-shadow: 0 0 10px #000;">é€‰æ‹© 3 ä½å‡ºæˆ˜ç¥å…½</h2>
            <div id="grid-container"></div>
            <div style="margin-top:30px;">
                <button class="btn" id="btn-deploy" onclick="Game.startRun()">å‡ºå¾ (0/3)</button>
                <button class="btn" onclick="Game.toMenu()" style="border-color:#666; color:#aaa;">è¿”å›</button>
            </div>
        </div>

        <div id="scene-reward" class="scene hidden scene-dark">
            <h2 style="color:var(--gold); font-size: 50px; margin-bottom: 10px;">æˆ˜æ–—èƒœåˆ©ï¼</h2>
            <p style="color:#aaa; font-size: 20px; margin-bottom: 40px;">å¤©é™èµç¦ï¼šè¯·é€‰æ‹©ä¸€ä½è§’è‰²è¿›è¡Œå¼ºåŒ–</p>
            <div id="reward-grid" style="display:flex; justify-content:center; gap:40px;"></div>
        </div>

        <div id="scene-battle" class="scene hidden scene-dark" style="background:none;">
            <div id="battle-scene">
<div id="action-bar-container">
            </div>
                <div class="main-stage">
                    <div class="top-bar">
                        <button class="btn" style="font-size:18px; padding:5px 20px; min-width:auto;" onclick="Game.pause()">æš‚åœ</button>
                        <div style="font-size:28px; color:var(--gold); text-shadow: 0 2px 4px #000;">ç¬¬ <span id="ui-lvl" style="font-size:36px; font-weight:bold;">1</span> å±‚</div>
                    </div>

                    <div class="field">
                        <div class="unit" id="u-enemy">
                            <div class="skill-banner" id="banner-enemy"></div>
                            <div class="buffs" id="buff-e"></div>
                            <div class="avatar" id="av-e" style="border-color:var(--red);"><img id="img-e" src=""></div>
                            <div style="font-size:24px; color:var(--red); margin-top:10px; text-shadow: 1px 1px 2px #000;"><span id="name-e">BOSS</span> <span id="hp-txt-e"></span></div>
                            <div class="hp-bar"><div class="hp-fill hp-e" id="bar-e" style="width:100%"></div></div>
                        </div>
                        <div style="font-size:100px; color:rgba(255,255,255,0.2); font-family:'my_font'">VS</div>
                        <div class="unit" id="u-player">
                            <div class="skill-banner" id="banner-player"></div>
                            <div class="buffs" id="buff-p"></div>
                            <div class="avatar" id="av-p" style="border-color:var(--blue);"><img id="img-p" src="images/avatar_player.png" onerror="this.src='//via.placeholder.com/200'"></div>
                            <div style="font-size:24px; color:var(--blue); margin-top:10px; text-shadow: 1px 1px 2px #000;"><span>å”¤çµå¸ˆ</span> <span id="hp-txt-p"></span></div>
                            <div class="hp-bar"><div class="hp-fill hp-p" id="bar-p" style="width:100%"></div></div>
                        </div>
                    </div>
<div id="sp-bar-container" style="display:flex; justify-content:center; gap:10px; margin-bottom:10px; min-height: 30px; align-items: center;">
    </div>
                    <div id="hand-zone"></div>
                </div>
                <div class="mini-log">
                    <div class="log-header">æˆ˜æ–—è®°å½•</div>
                    <div id="log-content"></div>
                </div>
            </div>
        </div>

        <div id="scene-gallery" class="scene hidden scene-dark">
            <h2 style="color:var(--gold); font-size: 40px; text-shadow: 0 0 20px var(--gold);">ä¸‡å…½å›¾é‰´</h2>
            <div id="gallery-grid"></div>
            <button class="btn" onclick="Game.toMenu()" style="margin-top: 20px;">è¿”å›</button>
        </div>

        <div id="scene-story" class="scene hidden">
            <h2 style="color:var(--purple); font-size: 50px; text-shadow: 0 0 20px var(--purple); margin-bottom: 10px;">ä¸‡çµ â€§ æ•…äº‹é˜</h2>
            <div style="color:#aaa; margin-bottom: 30px; font-size: 18px;">è†å¬ç¥å…½ä»¬çš„è¿‡å¾€ä¸ç¾ç»Š</div>
            <div id="story-list"></div>
            <button class="btn" onclick="Game.toMenu()" style="margin-top: 20px; border-color:var(--purple);">è¿”å›ä¸»é¡µ</button>
        </div>

        <div id="modal-story" class="modal hidden">
            <div class="story-view">
                <div class="sv-left">
                    <img id="sv-img" src="">
                    <div class="sv-name-overlay">
                        <h1 id="sv-name"></h1>
                        <div id="sv-role"></div>
                    </div>
                    <button class="btn" style="position:absolute; top:20px; left:20px; width:80px; min-width:auto; padding:5px; font-size:16px; background:rgba(0,0,0,0.5);" 
    onclick="Game.stopVoice(); document.getElementById('modal-story').classList.add('hidden')">
    å…³é—­
</button>
                </div>
                <div class="sv-right" id="sv-content" onclick="Game.openBookMode()" title="ç‚¹å‡»æ”¾å¤§é˜…è¯»"></div>
            </div>
        </div>

        <div id="book-overlay" onclick="Game.closeBookMode()">
            <div class="book-page" id="book-content" onclick="event.stopPropagation()"></div>
            <div class="book-close-hint">ç‚¹å‡»ç©ºç™½å¤„å…³é—­é˜…è¯»</div>
        </div>

        <div id="modal-detail" class="modal hidden">
    <div class="detail-view">
        <div class="dv-img">
            <img id="dv-img" src="">
        </div>
        
        <div class="dv-info">
            <h1 id="dv-name" style="color:var(--gold); margin-top:0; font-size: 50px; font-family: 'my_font', serif;"></h1>
            <div id="dv-role" style="font-size: 20px; margin-bottom:25px; font-weight: bold; opacity: 0.8;"></div>
            
            <div style="width: 100%; height: 1px; background: rgba(255,255,255,0.2); margin-bottom: 20px;"></div>
            
            <div id="dv-desc" style="margin-bottom:30px; color:#ddd; font-size: 18px; line-height: 1.6;"></div>
            <div id="dv-skills" style="font-size: 16px;"></div>
            
            <div style="margin-top:auto; display: flex; gap: 15px; padding-top: 20px;">
                <button class="btn" style="min-width: auto; padding: 8px 25px; font-size: 18px;" onclick="Game.setDvForm('beast')">å…½æ€</button>
                <button class="btn" style="min-width: auto; padding: 8px 25px; font-size: 18px;" onclick="Game.setDvForm('q')">Qç‰ˆ</button>
                <button class="btn" style="min-width: auto; padding: 8px 25px; font-size: 18px;" onclick="Game.setDvForm('human')">æ‹Ÿäºº</button>
                
                <button class="btn" style="min-width: auto; padding: 8px 25px; font-size: 18px; background: transparent; border-color: #666; color: #aaa; margin-left: auto;" 
                        onclick="document.getElementById('modal-detail').classList.add('hidden'); Game.stopVoice();">
                    å…³é—­
                </button>
            </div>
        </div>
    </div>
</div>
        <div id="modal-msg" class="modal hidden">
            <div class="modal-box">
                <h1 id="msg-t" style="color:var(--gold); font-size: 50px;"></h1>
                <p id="msg-d" style="font-size:24px; margin:40px 0; color: #eee;"></p>
                <div id="msg-b" style="display: flex; justify-content: center; gap: 20px;"></div>
            </div>
        </div>
    </div>
</div>

<div id="action-bar-container">
            </div>
        ```
<script>
// ğŸŸ¢ æ ¸å¿ƒä¿®å¤å‡½æ•°ï¼šä¿è¯æ¸¸æˆæ°¸è¿œå±…ä¸­ä¸”ç¼©æ”¾æ­£ç¡®
    function resize() 
{
        // 1. è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
        const scale = Math.min(window.innerWidth / 1920, window.innerHeight / 1080
);
        
        // 2. æ‰¾åˆ°æ¸¸æˆå®¹å™¨
        const wrapper = document.getElementById('scale-wrapper'
);
        
        // 3. ğŸ”´ å…³é”®ä¸€æ­¥ï¼š
        // å…ˆ translate(-50%, -50%) è®©å®ƒå±…ä¸­
        // å scale(...) è®©å®ƒç¼©æ”¾
        // é¡ºåºä¸èƒ½é”™ï¼Œä¸”å¿…é¡»å†™åœ¨ä¸€èµ·ï¼
        wrapper.style.transform = 
`translate(-50%, -50%) scale(${scale})`
;
    }

    // ç›‘å¬çª—å£å˜åŒ–
    window
.onresize = resize;
    
    // å¼ºåˆ¶æ‰§è¡Œä¸¤æ¬¡ï¼Œé˜²æ­¢åŠ è½½å»¶è¿Ÿå¯¼è‡´ç¬¬ä¸€æ¬¡è®¡ç®—å¤±è´¥
    resize();
    setTimeout(resize, 100
);

const CARDS = [
    // --- 1. ä¹å°¾ç‹ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "fox-1" å’Œé«˜æ•°å€¼ï¼Œæ¤å…¥äº†å‰§æƒ…ç‰ˆæ•…äº‹) ---
    { 
        id: 1, name: "ä¹å°¾ç‹", role: "æ¯ç­", type: "atk", color: "#ff4d4d", 
        desc: "æè‡´çˆ†å‘ã€‚å¯¹æ˜“ä¼¤æ•Œäººå¿…æš´å‡»ã€‚", 
        lines: { pick: "æ—¢ç„¶ä½ è¯šå¿ƒé‚€è¯·ï¼Œé‚£ä¾¿é™ªä½ ç©ç©ã€‚", idle: "æ¼«æ¼«é•¿å¤œï¼Œæ— å¿ƒç¡çœ ï¼Œæ¥å¬å¥´å®¶è®²ä¸ªæ•…äº‹ï¼Ÿ", s1: "è¿™ç‚¹ç«ï¼Œçƒ§å¾—å°½äººå¿ƒå—ï¼Ÿ", s2: "çœ‹ç€æˆ‘çš„çœ¼ç›ï¼", ult: "å€¾å›½å€¾åŸï¼Œä¸‡åŠ«ä¸å¤ï¼" }, 
        skills:[ 
            // æ³¨æ„ï¼šè¿™é‡Œä¿ç•™äº†ç¬¬äºŒä¸ªä»£ç çš„ fox-1 ç‰¹æ•ˆå’Œ 1.8 å€ç‡
            {n:"ç‹ç«", c:0, val:1.8, gain:25, vfx:"fox-1", d:"[æ™®æ”»] 180%ç«ä¼¤ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"æ‘„é­‚", c:0, val:4.8, gain:35, xp:25, vfx:"fox-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚480%ç«ä¼¤ã€‚è‹¥æ˜“ä¼¤åˆ™æš´å‡»ã€‚"}, 
            {n:"å€¾å›½", c:110, val:9.5, stun:true, xp:60, vfx:"fox-3", d:"[ç»ˆç»“æŠ€] æ¶ˆè€—110èƒ½é‡ã€‚950%ä¼¤å®³å¹¶çœ©æ™•BOSSï¼"} 
        ],
        // è¿™é‡Œæ¤å…¥äº†ç¬¬ä¸€ä¸ªä»£ç çš„ä¸°å¯Œæ•…äº‹
        story: { 
            bio: "<b>ã€å‰å°˜ã€‘</b> å¥´å®¶å¹¼æ—¶ï¼Œä»¥ä¸ºä¿®å‡ºä¹å°¾ä¾¿æ˜¯è¿™ä¸–é—´æœ€è£è€€ä¹‹äº‹ã€‚ä¸ºäº†åŒ–å½¢ï¼Œæˆ‘åå™¬åŒæ—ï¼Œåœ¨é›·åŠ«ä¸­ä¹æ­»ä¸€ç”Ÿã€‚<br><b>ã€ä»Šç”Ÿã€‘</b> åæ¥æˆ‘åœ¨äººé—´èµ°äº†ä¸€é­ï¼Œåšè¿‡å® å¦ƒï¼Œå½“è¿‡ç¥¸æ°´ã€‚æœ€ç»ˆå‘ç°äººå¿ƒæ¯”å¦–åŠ›æ›´æ˜“æ“æ§ã€‚å¦‚ä»Šè¿™é’ä¸˜ï¼Œä¸è¿‡æ˜¯å¥´å®¶çœ‹é€çº¢å°˜åçš„ä¸€ä¸ªç¬¼å­ç½¢ã€‚", 
            bg: "é’ä¸˜ä¹‹å±±ï¼Œæœ‰å…½ç„‰ï¼Œå…¶çŠ¶å¦‚ç‹è€Œä¹å°¾ã€‚ä¸–äººéª‚æˆ‘å¦²å·±ï¼Œéª‚æˆ‘å¦–å­½ï¼Œå´åˆåœ¨å¤œé‡Œå·å·æ±‚æˆ‘èµäºˆå§»ç¼˜ã€‚å‘µï¼Œç”·äººï¼ŒçœŸæ˜¯è™šä¼ªçš„ç”Ÿç‰©ã€‚", 
            voice: { bio: "story_1_bio.wav", bg: "story_1_bg.wav" }, 
            impressions: {
                2: { meet: "é‚£å¤©æˆ‘æ­£åœ¨æ¢³å¦†ï¼Œè¿™å‘†å­å†²å‡ºæ¥è¦å•ƒæˆ‘çš„èƒ­è„‚ï¼Œè¯´æ˜¯é—»åˆ°äº†é¦™ç”œå‘³ã€‚", imp: "ä¸€ä¸ªå¡«ä¸æ»¡çš„æ— åº•æ´ã€‚åªè¦ç»™ä»–åƒçš„ï¼Œè®©ä»–å’¬è°ä»–ä¾¿å’¬è°ï¼Œå€’æ˜¯ä¸€æŠŠå¥½ç”¨çš„åˆ€ã€‚", v_meet: "meet_1_to_2.wav", v_imp: "imp_1_to_2.wav" },
                3: { meet: "æˆ˜åœºä¸Šï¼Œä»–æµ‘èº«æ˜¯è¡€åœ°ä»å°¸å †é‡Œçˆ¬å‡ºæ¥ï¼Œçœ¼ç¥æ¯”é‡å…½è¿˜å‡¶ã€‚", imp: "æ¯«æ— é£æƒ…çš„ç–¯ç‹—ã€‚ä½†ä»–é‚£è‚¡çº¯ç²¹çš„æ€æ„ï¼Œåœ¨è¿™ä¸ªè™šä¼ªçš„ä¸–é“é‡Œï¼Œåå€’æ˜¾å¾—æœ‰äº›çœŸå®ã€‚", v_meet: "meet_1_to_3.wav", v_imp: "imp_1_to_3.wav" },
                4: { meet: "æˆ‘æ­£å› è¢«ä¸–äººè¯¯è§£è€Œå“­æ³£ï¼Œè¿™å°å®¶ä¼™é’»å‡ºæ¥ï¼Œç”¨å°¾å·´æ“¦äº†æˆ‘çš„æ³ªã€‚", imp: "è½¯ç»µç»µçš„å°å¦¹å¦¹ï¼Œæ˜¯å¥´å®¶å”¯ä¸€ä¸å¿å¿ƒæ¬ºè´Ÿçš„å­˜åœ¨ã€‚", v_meet: "meet_1_to_4.wav", v_imp: "imp_1_to_4.wav" },
                5: { meet: "å¥¹æ‹¿ç€æ¯’æœå­éª—æˆ‘æ˜¯é©»é¢œä¸¹ã€‚å“¼ï¼Œè¿™ç§å°æŠŠæˆï¼Œå¥´å®¶äº”ç™¾å¹´å‰å°±ç©è…»äº†ã€‚", imp: "é˜´é™©çš„å°é­”å¥³ã€‚ä¸è¿‡å¥¹çš„æ¯’æœ‰æ—¶å€™æ¯”åˆ€å‰‘è¿˜å¥½ç”¨ï¼Œè¿™ç§åå¿ƒçœ¼ï¼Œå¥´å®¶å€’æ˜¯ä¸è®¨åŒã€‚", v_meet: "meet_1_to_5.wav", v_imp: "imp_1_to_5.wav" },
                6: { meet: "å½“å¹´å¥¹å¼•å‘çš„å¤§æ°´æ·¹æ²¡äº†æˆ‘çš„é’ä¸˜æ´åºœï¼Œå¼„æ¹¿äº†æˆ‘æœ€çˆ±çš„äº‘é”¦è£³ï¼Œä¸ºæ­¤æˆ‘å¯æ˜¯ä¼¤å¿ƒäº†å¥½ä¹…", imp: "æ°´åšçš„å¦¹å¦¹ï¼Œå¤ªå†·å†°å†°äº†ã€‚çœ¼æ³ªæ˜¯å¥³äººæœ€æ— ç”¨çš„æ­¦å™¨ï¼Œå¥¹ä»€ä¹ˆæ—¶å€™æ‰èƒ½æ˜ç™½ï¼Ÿ", v_meet: "meet_1_to_6.wav", v_imp: "imp_1_to_6.wav" },
                7: { meet: "å½“å¹´æˆ‘è¿˜æ˜¯å°é‡ç‹æ—¶ï¼Œé™©äº›è¢«çŒäººå‰¥çš®ï¼Œæ˜¯è¿™ä½â€œå…ˆç”Ÿâ€è·¯è¿‡æ•‘äº†æˆ‘ã€‚", imp: "æ»¡å£å¤§é“ç†çš„ä¹¦å‘†å­ã€‚è™½ç„¶é•¿å¾—ä¸é”™ï¼Œå¯æƒœå¤ªæ­£ç»äº†ï¼Œä¸€ç‚¹éƒ½ä¸å¥½ç©ã€‚", v_meet: "meet_1_to_7.wav", v_imp: "imp_1_to_7.wav" },
                8: { meet: "åœ¨ç˜Ÿç–«ä¸­ï¼Œæˆ‘è§å¥¹è€—å°½çµåŠ›æ•‘æ²»é‚£äº›æ›¾ç»å”¾éª‚æˆ‘ä»¬çš„å‡¡äººã€‚", imp: "æ´»å¾—å¤ªä¹…ï¼Œå´ä¾ç„¶å¤©çœŸã€‚å¥¹æ˜¯ä¸ªæ¸©æŸ”çš„å‚»å§å§ï¼Œä½†è¿™ä¸–é“ï¼Œæ¸©æŸ”å¾€å¾€æ˜¯æœ€è‡´å‘½çš„å¼±ç‚¹ã€‚", v_meet: "meet_1_to_8.wav", v_imp: "imp_1_to_8.wav" },
                9: { meet: "æˆ‘æƒ³ç»™å¤©ä¸Šçš„ç¥å¯„ä¸€å°æƒ…ä¹¦ï¼Œæ±‚äº†å¥¹ä¸‰å¤©ä¸‰å¤œã€‚", imp: "å‚²å¨‡çš„å°ä¸«å¤´ã€‚é£å¾—é‚£ä¹ˆå¿«ï¼Œä¹Ÿä¸çŸ¥åœä¸‹æ¥çœ‹çœ‹æ²¿é€”çš„é£æ™¯ã€‚", v_meet: "meet_1_to_9.wav", v_imp: "imp_1_to_9.wav" }
            } 
        } 
    },
    
    // --- 2. é¥•é¤® (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "tao-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 2, name: "é¥•é¤®", role: "å­˜æŠ¤", type: "atk", color: "#ff8a65", 
        desc: "åå™¬å›è¡€ã€‚è¶Šæˆ˜è¶Šå‹‡ã€‚", 
        lines: { pick: "åªè¦ç®¡é¥±ï¼Œå‘½éƒ½ç»™ä½ ï¼", idle: "é¥¿...é‚£ç§æ„Ÿè§‰å°±åƒèƒƒé‡Œæœ‰ä¸€å›¢ç«...", s1: "æ’•ç¢ï¼", s2: "è¿éª¨å¤´éƒ½ä¸å‰©ï¼", ult: "å¤©åœ°ä¸‡ç‰©ï¼Œçš†å…¥æˆ‘è…¹ï¼" }, 
        skills:[ 
            {n:"æ’•å’¬", c:0, val:1.5, heal:1000, gain:25, vfx:"tao-1", d:"[æ™®æ”»] 150%ä¼¤å®³ï¼Œè‡ªæˆ‘å›è¡€1000ã€‚"}, 
            {n:"åå™¬", c:0, val:3.5, heal:4000, gain:35, xp:25, vfx:"tao-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚350%ä¼¤å®³ï¼Œå¼ºåŠ›å›è¡€4000ã€‚"}, 
            {n:"æš´é£Ÿ", c:100, val:7.0, heal:99999, xp:60, vfx:"tao-3", d:"[ç»ˆç»“æŠ€] 700%ä¼¤å®³ï¼Œè‡ªèº«è¡€é‡ã€å®Œå…¨å›æ»¡ã€‘ï¼"} 
        ],
        story: { 
            bio: "<b>ã€é¥¥è’ã€‘</b> å‡ºç”Ÿçš„æ—¶å€™ï¼Œæˆ‘å¤ªé¥¿äº†ï¼Œä¸å°å¿ƒåƒæ‰äº†è‡ªå·±çš„è›‹å£³ã€‚ä¸€å²æ—¶ï¼Œæˆ‘åƒæ‰äº†åŠåº§é’©å¾å±±çš„çŸ³å¤´ã€‚ä½†æˆ‘è¿˜æ˜¯é¥¿...é‚£ç§ç©ºè™šæ„Ÿæ€ä¹ˆå¡«éƒ½å¡«ä¸æ»¡ã€‚<br><b>ã€é¢†æ‚Ÿã€‘</b> åæ¥æˆ‘å‘ç°ï¼Œæƒ…ç»ªä¹Ÿæ˜¯ä¸€é“ç¾å‘³ã€‚ææƒ§æ˜¯è¾£çš„ï¼Œç»æœ›æ˜¯è‹¦çš„ã€‚åªè¦èƒ½å¡«é¥±è‚šå­ï¼Œç®¡ä»–æ˜¯äººæ˜¯ç¥ï¼Œæˆ‘å…¨éƒ½è¦åƒæ‰ï¼", 
            bg: "æˆ‘æ˜¯è´ªå©ªçš„åŒ–èº«ï¼Œè…‹ä¸‹é•¿çœ¼ï¼Œè™é½¿äººçˆªã€‚ä½ ä»¬æŠŠæˆ‘çš„å¤´çº¹åˆ»åœ¨é¼ä¸Šç¥ˆæ±‚å¯Œè´µï¼Ÿè®½åˆºçš„æ˜¯ï¼Œæˆ‘åªæƒ³è¦ä½ ä»¬é¼é‡Œçš„è‚‰ï¼", 
            voice: { bio: "story_2_bio.wav", bg: "story_2_bg.wav" }, 
            impressions: {
                1: { meet: "å¥¹éª—æˆ‘è¯´å¤©ä¸Šçš„æœˆäº®æ˜¯æœ€å¤§çš„çƒ§é¥¼ã€‚æˆ‘è¿½äº†ä¸€æ•´æ™šï¼Œåªå–äº†è¥¿åŒ—é£ã€‚", imp: "éª—å­ï¼ä½†æ˜¯...å¥¹èº«ä¸Šæœ‰è‚¡é¦™é¦™çš„å‘³é“ï¼Œä¸çŸ¥é“å’¬ä¸€å£æ˜¯ä»€ä¹ˆæ»‹å‘³ã€‚", v_meet: "meet_2_to_1.wav", v_imp: "imp_2_to_1.wav" },
                3: { meet: "æˆ‘ä»¬åœ¨æŠ¢åŒä¸€ä¸ªçŒç‰©ã€‚ä»–è¦æ€äººï¼Œæˆ‘è¦åƒè‚‰ã€‚æœ€åæˆ‘ä»¬è¾¾æˆåè®®ï¼šä»–è´Ÿè´£æ€ï¼Œæˆ‘è´Ÿè´£åƒã€‚", imp: "æœ€ä½³é¥­æ­å­ã€‚è·Ÿç€ä»–èµ°ï¼Œæ°¸è¿œæœ‰çƒ­ä¹çš„è¡€è‚‰å¯ä»¥åƒã€‚", v_meet: "meet_2_to_3.wav", v_imp: "imp_2_to_3.wav" },
                4: { meet: "æˆ‘é¥¿æäº†æƒ³åƒå¥¹ï¼Œå¥¹éä½†ä¸è·‘ï¼Œè¿˜è·³åˆ°æˆ‘é¼»å­ä¸Šã€‚", imp: "åƒèµ·æ¥è‚¯å®šæ˜¯æ¯›å¤ªå¤šï¼Œè‚‰å¤ªé…¸ï¼Œå¡ç‰™ç¼éƒ½ä¸å¤Ÿã€‚ç•™ç€å½“å¤‡ç”¨ç²®å§ã€‚", v_meet: "meet_2_to_4.wav", v_imp: "imp_2_to_4.wav" },
                5: { meet: "å·åƒäº†é‚£ä¸«å¤´ç§çš„è˜‘è‡ï¼Œç»“æœçœ‹è§äº†å¥½å¤šå°äººï¼Œåäº†ä¸‰å¤©ã€‚", imp: "å¥¹çš„è‚‰è‚¯å®šæ˜¯è‹¦çš„ï¼Œæœ‰æ¯’ï¼é‚£ç–¯ä¸«å¤´å¤ªå¯æ€•äº†ï¼Œç¦»å¥¹è¿œç‚¹ã€‚", v_meet: "meet_2_to_5.wav", v_imp: "imp_2_to_5.wav" },
                6: { meet: "æˆ‘ä»¥ä¸ºå¥¹æ˜¯æ¡å¤§é±¼ï¼Œæ‰‘é€šä¸€å£°è·³ä¸‹æ°´å»æŠ“ã€‚ç»“æœæ°´å¤ªæ·±ï¼Œå·®ç‚¹æ·¹æ­»ã€‚", imp: "è™½ç„¶æ˜¯é±¼ï¼Œä½†çœ‹èµ·æ¥å†·å†°å†°çš„ï¼Œä¸å¥½åƒã€‚è€Œä¸”å¥¹æ•‘è¿‡æˆ‘ï¼Œè¿™æ¬¡å°±ä¸åƒå¥¹äº†ã€‚", v_meet: "meet_2_to_6.wav", v_imp: "imp_2_to_6.wav" },
                7: { meet: "å¤§å®¶éƒ½æ€•æˆ‘ï¼Œåªæœ‰è¿™ä¹¦ç”Ÿç»™æˆ‘åšäº†ä¸€ç¢—çº¢çƒ§è‚‰ï¼Œè¿˜é—®æˆ‘ä¸ºä»€ä¹ˆé¥¿ã€‚", imp: "è™½ç„¶æ˜¯ä¸ªå•°å—¦çš„å®¶ä¼™ã€‚ä½†ä»–åšçš„é¥­çœŸå¥½åƒï¼Œå¦‚æœä»–ä¸è®²å¤§é“ç†å°±æ›´å¥½äº†ã€‚", v_meet: "meet_2_to_7.wav", v_imp: "imp_2_to_7.wav" },
                8: { meet: "æˆ‘ç‰™ç–¼ã€‚é‚£ä¸ªå¥³äººæ‘¸äº†æ‘¸æˆ‘çš„è„¸ï¼Œç‰™å°±ä¸ç–¼äº†ã€‚", imp: "å¥½äººã€‚ä½†æˆ‘æ¢¦æ¸¸æ—¶å¥½åƒå•ƒäº†å¥¹ä¸€å£ï¼Œå´©æ‰åŠé¢—ç‰™...å¥¹çš„çš®å¤ªç¡¬äº†ã€‚", v_meet: "meet_2_to_8.wav", v_imp: "imp_2_to_8.wav" },
                9: { meet: "æˆ‘æƒ³æŠ“å¥¹ï¼Œå¥¹é£å¾—å¤ªå¿«ï¼Œè¿˜åœ¨æˆ‘å¤´ä¸Šæ‹‰äº†å¨é¸Ÿå±...", imp: "åµæ­»äººçš„é¸Ÿï¼è‚‰è‚¯å®šåˆæŸ´åˆç¡¬ã€‚åˆ«è®©æˆ‘æŠ“åˆ°ä½ ï¼", v_meet: "meet_2_to_9.wav", v_imp: "imp_2_to_9.wav" }
            } 
        } 
    },

    // --- 3. ç©·å¥‡ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "qiong-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 3, name: "ç©·å¥‡", role: "æ¯ç­", type: "atk", color: "#d32f2f", 
        desc: "ä»¥è¡€æ¢è¡€ã€‚ä½è¡€é‡é«˜æ–©æ€ã€‚", 
        lines: { pick: "å“ªé‡Œæœ‰æ€æˆ®ï¼Œå“ªé‡Œå°±æœ‰æˆ‘ï¼", idle: "ç—›æ¥šè®©æˆ‘å…´å¥‹ï¼", s1: "å¤ªå¼±äº†ï¼", s2: "è¡€å€ºè¡€å¿ï¼", ult: "åŒå½’äºå°½å§ï¼" }, 
        skills:[ 
            {n:"æ¶çˆª", c:0, val:2.0, gain:25, vfx:"qiong-1", d:"[æ™®æ”»] 200%ä¼¤å®³ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"è¡€ç¥­", c:0, val:6.0, self:1500, gain:35, xp:25, vfx:"qiong-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹&1500è¡€ã€‚600%å·¨é¢ä¼¤å®³ã€‚"}, 
            {n:"ææ¶", c:100, val:12.0, self:2500, xp:60, vfx:"qiong-3", d:"[ç»ˆç»“æŠ€] è‡ªæ®‹2500è¡€ã€‚é€ æˆ1200%æ¯ç­æ‰“å‡»ï¼"} 
        ],
        story: { 
            bio: "<b>ã€ä¿¡æ¡ã€‘</b> æˆ‘æœ€è®¨åŒé‚£äº›æ»¡å£ä»ä¹‰é“å¾·çš„ä¼ªå›å­ã€‚çœ‹è§æœ‰äººæ‰“æ¶ï¼Œæˆ‘å°±è¦å»å’¬æ­»é‚£ä¸ªå ç†çš„ï¼›çœ‹è§æœ‰äººè¯šå®ï¼Œæˆ‘å°±è¦å»åƒæ‰ä»–çš„é¼»å­ï¼<br><b>ã€æœ¬å¿ƒã€‘</b> ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºåªæœ‰æ··ä¹±å’Œæš´åŠ›ï¼Œæ‰æ˜¯æœ€çœŸå®çš„ã€‚åœ¨è¿™ä¸ªå¼±è‚‰å¼ºé£Ÿçš„ä¸–ç•Œï¼Œæˆ‘åªæ˜¯æ’•å¼€äº†é‚£å±‚è™šä¼ªçš„é¢çº±ï¼", 
            bg: "æˆ‘æ˜¯å°‘æ˜Šæ°çš„ä¸è‚–å­ï¼Œä¸“çˆ±æƒ©å–„æ‰¬æ¶ã€‚äººä»¬æ¨æˆ‘å…¥éª¨ï¼Œå´ä¸çŸ¥ä»–ä»¬å¿ƒä¸­çš„æ¶æ„ï¼Œæ­£æ˜¯æˆ‘åŠ›é‡çš„æºæ³‰ã€‚", 
            voice: { bio: "story_3_bio.wav", bg: "story_3_bg.wav" }, 
            impressions: {
                1: { meet: "æˆ˜åœºä¸Šï¼Œå¥¹åœ¨é‚£æ”é¦–å¼„å§¿ï¼Œä¹±æˆ‘å†›å¿ƒã€‚", imp: "ç‹¡çŒ¾çš„ç‹ç‹¸ã€‚å¥¹ä½œæ¶æ˜¯ä¸ºäº†ç”Ÿå­˜ï¼Œæˆ‘æ˜¯ä¸ºäº†ä¹è¶£ã€‚é“ä¸åŒï¼Œä¸ç›¸ä¸ºè°‹ã€‚", v_meet: "meet_3_to_1.wav", v_imp: "imp_3_to_1.wav" },
                2: { meet: "æˆ‘æ€å®Œäººæ­£è¦èµ°ï¼Œè¿™è´§å†²å‡ºæ¥æŠŠå°¸ä½“å…¨åƒäº†ï¼Œè¿˜é—®æˆ‘è¿˜æœ‰æ²¡æœ‰ã€‚", imp: "æ²¡è„‘å­çš„é¥­æ¡¶ã€‚åªè¦ç»™ä»–è‚‰ï¼Œè®©ä»–æ€è°éƒ½è¡Œã€‚å¾ˆå¥½ç”¨çš„å·¥å…·ã€‚", v_meet: "meet_3_to_2.wav", v_imp: "imp_3_to_2.wav" },
                4: { meet: "æˆ‘æ€çº¢äº†çœ¼ï¼Œæ­£å¤„äºç‹‚æš´è¾¹ç¼˜ï¼Œè¿™å°ä¸œè¥¿ä¸çŸ¥æ­»æ´»åœ°é è¿‡æ¥ã€‚", imp: "è¿™ç§è½¯å¼±çš„ç”Ÿç‰©ï¼Œå±…ç„¶è¿˜èƒ½æ´»åˆ°ç°åœ¨ï¼Ÿä½†åœ¨å¥¹èº«è¾¹ï¼Œæˆ‘çš„ç‹‚æ€’ç«Ÿç„¶å¹³æ¯äº†ã€‚", v_meet: "meet_3_to_4.wav", v_imp: "imp_3_to_4.wav" },
                5: { meet: "å¥¹åœ¨æ°´æºä¸‹æ¯’ï¼Œæ¯’æ­»äº†ä¸€åº§åŸçš„äººã€‚æˆ‘æ‰¾åˆ°å¥¹ï¼Œä¸ä»…æ²¡æ€å¥¹ï¼Œè¿˜å’Œå¥¹å–äº†ä¸€é¡¿é…’ã€‚", imp: "é˜´é™©çš„å¥³äººï¼Œä½†æˆ‘å–œæ¬¢ã€‚æš´åŠ›ä¸ä»…æ˜¯æ‹³å¤´ï¼Œæ¯’ä¹Ÿæ˜¯ä¸€ç§è‰ºæœ¯ã€‚", v_meet: "meet_3_to_5.wav", v_imp: "imp_3_to_5.wav" },
                6: { meet: "æ´ªæ°´æ»”å¤©æ—¶ï¼Œæˆ‘åœ¨å±±é¡¶ç‹‚ç¬‘ï¼Œå¥¹åœ¨æ°´åº•å“­æ³£ã€‚", imp: "ç¾æ˜Ÿã€‚å¥¹å¸¦æ¥çš„æ¯ç­æ¯”æˆ‘å£®è§‚å¤šäº†ï¼Œå¯å¥¹ååä¸€å‰¯å—å®³è€…çš„æ¨¡æ ·ï¼Œçœ‹ç€å°±æ¥æ°”ã€‚", v_meet: "meet_3_to_6.wav", v_imp: "imp_3_to_6.wav" },
                7: { meet: "ç™½æ³½...æˆ‘çš„ä¸€ç”Ÿä¹‹æ•Œï¼ç¬¬ä¸€æ¬¡è§é¢ä»–å°±ç”¨é‚£ç ´ä¹¦æŒ‡ç‚¹æˆ‘ï¼Œè¯´æˆ‘æœ‰'å¿ƒé­”'ã€‚", imp: "æ»¡å˜´å¤§é“ç†çš„ä¼ªå›å­ã€‚æ€»æœ‰ä¸€å¤©æˆ‘è¦æ’•çƒ‚ä»–çš„ä¹¦ï¼Œæ‹”å…‰ä»–çš„æ¯›ï¼", v_meet: "meet_3_to_7.wav", v_imp: "imp_3_to_7.wav" },
                8: { meet: "æˆ‘æŠŠäººæ‰“ä¸ªåŠæ­»ï¼Œé‚£ä¸ªå¥³äººå°±å»æ•‘æ´»ï¼›æˆ‘å†æ‰“ï¼Œå¥¹å†æ•‘ã€‚", imp: "å¤šç®¡é—²äº‹çš„å¥³äººã€‚ä½†å¥¹æ²»ä¼¤ç¡®å®æœ‰ä¸€æ‰‹ï¼Œç•™ç€å¥¹ï¼Œæˆ‘ä¹Ÿèƒ½å¤šæ‰“å‡ åœºæ¶ã€‚", v_meet: "meet_3_to_8.wav", v_imp: "imp_3_to_8.wav" },
                9: { meet: "å¥¹é€æ¥ä¸€å°ä¼‘æˆ˜ä¹¦ã€‚æˆ‘å½“åœºæ’•äº†ä¿¡ï¼Œé¡ºä¾¿æ‹”äº†å¥¹ä¸€æ ¹æ¯›ã€‚", imp: "è·‘è…¿çš„ã€‚é€ä¿¡è¿™ç§æ— èŠçš„äº‹ï¼Œåªæœ‰å¼±è€…æ‰åšã€‚", v_meet: "meet_3_to_9.wav", v_imp: "imp_3_to_9.wav" }
            } 
        } 
    },

    // --- 4. æœæœ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "fei-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 4, name: "æœæœ", role: "åŒè°", type: "buff", color: "#e040fb", 
        desc: "å…¨é˜Ÿå¢ä¼¤ã€‚æˆ˜æŠ€ç‚¹å‘åŠ¨æœºã€‚", 
        lines: { pick: "åˆ«éš¾è¿‡ï¼Œæ‘¸æ‘¸æˆ‘å°±å¥½äº†~", idle: "å–µ~", s1: "èµ°å¼€ï¼", s2: "å¼€å¿ƒç‚¹å˜›ï¼", ult: "æ„¿ä¸–é—´ï¼Œå†æ— å¿§æ„ï¼" }, 
        skills:[ 
            {n:"è¹­è¹­", c:0, val:1.3, gain:30, vfx:"fei-1", d:"[æ™®æ”»] 130%ä¼¤å®³ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"å¿˜å¿§", c:0, val:0, buff:"atk", gain:40, xp:25, vfx:"fei-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚å…¨é˜Ÿæ”»å‡»+50%ï¼ŒæŒç»­3å›åˆã€‚"}, 
            {n:"æä¹", c:110, val:0, buff:"dmg_boost", heal:5000, xp:60, vfx:"fei-3", d:"[ç»ˆç»“æŠ€] å…¨é˜Ÿå›è¡€5000ï¼Œå…¨ä½“ä¼¤å®³ç¿»å€(1å›åˆ)ï¼"} 
        ],
        story: { 
            bio: "<b>ã€èº«ä¸–ã€‘</b> æˆ‘ä½åœ¨éœå±±ï¼Œå¤§å®¶éƒ½è¯´æˆ‘æ˜¯åƒçŒ«ä¸€æ ·çš„å°å¯çˆ±ã€‚åªè¦å…»ç€æˆ‘ï¼Œå°±ä¸ä¼šæ„Ÿåˆ°æ‚²ä¼¤ã€‚<br><b>ã€ç§˜å¯†ã€‘</b> å…¶å®...åƒæ‰å¤ªå¤šçš„å™©æ¢¦å’Œæ‚²ä¼¤ï¼Œæˆ‘çš„è‚šå­ä¹Ÿä¼šç—›çš„ã€‚ä½†åªè¦çœ‹åˆ°å¤§å®¶éœ²å‡ºç¬‘å®¹ï¼Œæˆ‘å°±è§‰å¾—ä¸€åˆ‡éƒ½å€¼å¾—å•¦ï¼å¿«æ¥æŠ±æŠ±æˆ‘ï¼Œæˆ‘å¾ˆæš–å’Œå“¦ã€‚", 
            bg: "éœå±±æœ‰å…½ç„‰ï¼Œå…¶çŠ¶å¦‚ç‹¸ï¼Œè€Œç™½å°¾ï¼Œåæ›°æœæœï¼Œå…»ä¹‹å¯ä»¥å·²å¿§ã€‚ä¸–äººçš†è‹¦ï¼Œå”¯æœ‰è‡ªæ¸¡ã€‚è€Œæˆ‘ï¼Œæ„¿åšé‚£æ¸¡äººçš„èˆŸã€‚", 
            voice: { bio: "story_4_bio.wav", bg: "story_4_bg.wav" }, 
            impressions: {
                1: { meet: "æˆ‘åœ¨æ ‘æ—é‡Œè¿·è·¯äº†ï¼Œæ˜¯æ¼‚äº®å§å§å¸¦æˆ‘èµ°å‡ºæ¥çš„ã€‚", imp: "åˆ€å­å˜´è±†è…å¿ƒçš„å§å§ã€‚å¥¹å¿ƒé‡Œè—ç€å¾ˆå¤šä¸å¼€å¿ƒçš„äº‹ï¼Œæˆ‘æƒ³å¸®å¥¹åƒæ‰ã€‚", v_meet: "meet_4_to_1.wav", v_imp: "imp_4_to_1.wav" },
                2: { meet: "ä»–è‚šå­é¥¿çš„æ—¶å€™æœ€æš´èºï¼Œæˆ‘å°±å”±æ­Œå“„ä»–ç¡ã€‚ä»–ç¡ç€æ—¶å‘¼å™œå£°éœ‡å¤©å“ã€‚", imp: "ä»–å…¶å®å¾ˆç®€å•ï¼Œåªè¦åƒé¥±äº†å°±å¾ˆä¹–ã€‚æˆ‘ä¼šåŠªåŠ›ä¸è¢«ä»–åƒæ‰çš„ï¼", v_meet: "meet_4_to_2.wav", v_imp: "imp_4_to_2.wav" },
                3: { meet: "ä»–æµ‘èº«æ˜¯ä¼¤åœ°èººåœ¨è·¯è¾¹ï¼Œæˆ‘å·å·ç»™ä»–ç›–äº†ç‰‡å¶å­ã€‚", imp: "é‚£ä¸ªå‡¶å‡¶çš„å¤§å“¥å“¥ï¼Œå…¶å®å¾ˆå­¤ç‹¬å§ï¼Ÿä»–çš„æ¢¦é‡Œå…¨æ˜¯è¡€å’Œç«ï¼Œä¸€å®šå¾ˆç—›ã€‚", v_meet: "meet_4_to_3.wav", v_imp: "imp_4_to_3.wav" },
                5: { meet: "å¥¹ç»™äº†æˆ‘ä¸€é¢—ç³–ï¼Œç»“æœæˆ‘åƒäº†ä¹‹åä¸€ç›´æ‰“å—ï¼Œæ‰“å‡ºæ¥çš„æ°”æ˜¯ç´«è‰²çš„ï¼", imp: "åå¿ƒçœ¼çš„å§å§ï¼Œæ€»æ˜¯æƒ³ä½œå¼„æˆ‘ã€‚ä½†æˆ‘ç™¾æ¯’ä¸ä¾µï¼Œç•¥ç•¥ç•¥ï¼", v_meet: "meet_4_to_5.wav", v_imp: "imp_4_to_5.wav" },
                6: { meet: "æˆ‘åœ¨æ²³è¾¹ç©ï¼Œå¥¹çªç„¶æµ®å‡ºæ°´é¢ï¼Œæ‚²ä¼¤åœ°çœ‹ç€æˆ‘ã€‚", imp: "é±¼å§å§å¤ªæ‚²ä¼¤äº†ï¼Œå¥¹çš„çœ¼æ³ªå˜æˆäº†æ´ªæ°´ã€‚å¥¹çš„æ‚²ä¼¤å¤ªå’¸äº†ï¼Œæˆ‘ä¸€ä¸ªäººåƒä¸å®Œã€‚", v_meet: "meet_4_to_6.wav", v_imp: "imp_4_to_6.wav" },
                7: { meet: "æˆ‘è¿˜æ˜¯ä¸ªå°æ¯›çƒçš„æ—¶å€™ï¼Œç™½æ³½å…ˆç”Ÿå°±æŠ±è¿‡æˆ‘ã€‚", imp: "å…ˆç”Ÿä»€ä¹ˆéƒ½æ‡‚ï¼Œä½†æˆ‘ä¸æƒ³åƒæ‰ä»–çš„çƒ¦æ¼ï¼Œå› ä¸ºé‚£äº›çƒ¦æ¼å¤ªæ²‰é‡äº†ã€‚", v_meet: "meet_4_to_7.wav", v_imp: "imp_4_to_7.wav" },
                8: { meet: "æˆ‘ä»¬ä¸€èµ·å»è¿‡ç™½æ°‘å›½ã€‚æˆ‘ä»¬ååœ¨å±‹é¡¶ä¸Šå¹äº†ä¸€æ•´æ™šçš„æ°”ã€‚", imp: "ä¹˜é»„å§å§å¾ˆæ¸©æŸ”ï¼Œæ€€æŠ±å¾ˆæš–å’Œï¼Œåƒå¦ˆå¦ˆä¸€æ ·ã€‚", v_meet: "meet_4_to_8.wav", v_imp: "imp_4_to_8.wav" },
                9: { meet: "å¥¹é£å¾—å¤ªæ€¥æ’åˆ°äº†æ ‘ä¸Šï¼Œæ˜¯æˆ‘å¸®å¥¹æ‰çš„è„‘è¢‹ã€‚", imp: "é’é¸Ÿå§å§æ€»æ˜¯å¾ˆå¿™ã€‚é£æ¥é£å»ä¸ç´¯å—ï¼Ÿå¥¹æ¯æ¬¡å›æ¥ï¼Œéƒ½ä¼šè®²äº‘ä¸Šé¢çš„æ•…äº‹ç»™æˆ‘å¬ã€‚", v_meet: "meet_4_to_9.wav", v_imp: "imp_4_to_9.wav" }
            } 
        } 
    },

    // --- 5. è€³é¼  (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "shu-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 5, name: "è€³é¼ ", role: "è™šæ— ", type: "buff", color: "#aa00ff", 
        desc: "å æ¯’å¼•çˆ†ã€‚Bosså…‹æ˜Ÿã€‚", 
        lines: { pick: "æƒ³è¯•è¯•æ–°é…æ–¹å—ï¼Ÿ", idle: "è¿™ä¹Ÿæ˜¯è¯å“¦~", s1: "å’¬ä½ ä¸€å£ï¼", s2: "å‰§æ¯’æ‰©æ•£ï¼", ult: "ä¸‡æ¯’å½’å®—ï¼" }, 
        skills:[ 
            {n:"æ¯’ç‰™", c:0, val:1.2, dot:1000, gain:25, vfx:"shu-1", d:"[æ™®æ”»] ä¼¤å®³ä¸€èˆ¬ï¼Œæ–½åŠ 1000ç‚¹æ¯’ã€‚"}, 
            {n:"ç˜Ÿç–«", c:0, val:2.0, dot:2500, debuff:"vuln", gain:35, xp:25, vfx:"shu-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚æ–½åŠ 2500æ¯’+æ˜“ä¼¤ã€‚"}, 
            {n:"æ¯’çˆ†", c:100, val:6.5, dot:5000, xp:60, vfx:"shu-3", d:"[ç»ˆç»“æŠ€] 650%ä¼¤å®³ï¼Œæ–½åŠ 5000ç‚¹æ°¸ä¹…å‰§æ¯’ï¼"} 
        ],
        story: { 
            bio: "<b>ã€å¤©èµ‹ã€‘</b> åˆ«çœ‹æœ¬å°å§ä¸ªå­å°ï¼Œæˆ‘å¯æ˜¯ç™¾æ¯’ä¸ä¾µçš„ï¼é‚£äº›æƒ³åƒæˆ‘çš„å®¶ä¼™ï¼Œæœ€åéƒ½æ‚ç€è‚šå­å€’ä¸‹äº†ã€‚<br><b>ã€æ¶ä½œå‰§ã€‘</b> æˆ‘å°éäº†å¤©ä¸‹çš„æ¯’è‰ï¼Œå‘ç°æ¯’å’Œè¯å…¶å®æ˜¯ä¸€å›äº‹ã€‚ä½ ä¹Ÿæƒ³å°å°è¿™ä¸ªç´«è‰²çš„è˜‘è‡å—ï¼Ÿå¾ˆç”œçš„å“¦~å˜»å˜»ï¼Œéª—ä½ çš„ï¼Œåƒäº†ä¼šè·³ä¸‰å¤©çš„èˆåœä¸ä¸‹æ¥ï¼", 
            bg: "ä¸¹ç†ä¹‹å±±ï¼Œæœ‰å…½ç„‰ï¼Œå…¶çŠ¶å¦‚é¼ ï¼Œè€Œå…”é¦–éº‹èº«ï¼Œä»¥å…¶å°¾é£ã€‚æˆ‘æ˜¯å¤©ç”Ÿçš„è¯ç½å­ï¼Œä¹Ÿæ˜¯å¤©ç”Ÿçš„æ¯’ç‰©ã€‚å°ä¸ªå­ä¹Ÿæœ‰å¤§æ™ºæ…§ï¼ˆå’Œåå¿ƒçœ¼ï¼‰ã€‚", 
            voice: { bio: "story_5_bio.wav", bg: "story_5_bg.wav" }, 
            impressions: {
                1: { meet: "è¶å¥¹ç¡è§‰ï¼Œæˆ‘åœ¨å¥¹çš„èƒ­è„‚é‡ŒåŠ äº†ç—’ç—’ç²‰ã€‚çœ‹å¥¹å½“ä¼—æŠ“ç—’ï¼Œç¬‘æ­»æˆ‘äº†ï¼", imp: "ç‹ç‹¸ç²¾å§å§æ‡‚ä»€ä¹ˆè¯ç†ï¼Ÿå°±ä¼šç”¨é­…æœ¯ã€‚ä¸è¿‡å¥¹è¦æ˜¯è‚¯è¯•è¯ï¼Œæœ¬å°å§å¯ä»¥è€ƒè™‘å°‘æ”¶ç‚¹è´¹ã€‚", v_meet: "meet_5_to_1.wav", v_imp: "imp_5_to_1.wav" },
                2: { meet: "è¿™å®¶ä¼™ç®€ç›´æ˜¯ç¥å†œå†ä¸–ï¼Œåƒä»€ä¹ˆéƒ½ä¸æ­»ã€‚æˆ‘å–‚ä»–æ–­è‚ è‰ï¼Œä»–å½“éŸ­èœåƒã€‚", imp: "å®Œç¾çš„è¯•è¯å¯¹è±¡ï¼åªæœ‰è¿™ä¸ªç¬¨å“¥å“¥æ•¢åƒæˆ‘çš„å¤±è´¥å“ã€‚ä½œä¸ºå›æŠ¥ï¼Œæˆ‘å¸®ä»–æ²»å¥½äº†æ¶ˆåŒ–ä¸è‰¯ã€‚", v_meet: "meet_5_to_2.wav", v_imp: "imp_5_to_2.wav" },
                3: { meet: "æˆ‘ä»¬äº¤æµè¿‡æ€äººçš„è‰ºæœ¯ã€‚æˆ‘ä¸»å¼ æ— å£°æ— æ¯ï¼Œä»–ä¸»å¼ è¡€è‚‰æ¨ªé£ã€‚", imp: "ç²—é²çš„é‡è›®äººã€‚ä»–å—ä¼¤äº†ä»ä¸æ•·è¯ï¼ŒåªçŸ¥é“èˆ”ã€‚çœŸæ˜¯ä¸å«ç”Ÿã€‚", v_meet: "meet_5_to_3.wav", v_imp: "imp_5_to_3.wav" },
                4: { meet: "æˆ‘æƒ³ç”¨ç¬‘æ°”è®©ä»–ç¬‘æ­»ï¼Œç»“æœä»–å±…ç„¶ç¡ç€äº†...", imp: "å°å‚»ç“œã€‚æ—¢ç„¶æ¯’ä¸æ­»ï¼Œé‚£å°±ç•™ç€å½“å® ç‰©å§ã€‚å¿ƒæƒ…ä¸å¥½çš„æ—¶å€™ææå¥¹ä¹Ÿä¸é”™ã€‚", v_meet: "meet_5_to_4.wav", v_imp: "imp_5_to_4.wav" },
                6: { meet: "å¥¹çš„æ°´æ¼«çŒäº†æˆ‘çš„è‰è¯ç”°ï¼æˆ‘è¾›è‹¦ç§çš„æ–­è‚ è‰å•Šï¼å…¨æ³¡æ±¤äº†ï¼", imp: "é‚£ä¸ªå“­å“­å•¼å•¼çš„å¥³äººã€‚æˆ‘å¾€å¥¹çš„æ°´é‡Œå€’äº†è§£æ¯’å‰‚ï¼Œæƒ³æŠŠå¥¹çš„é±¼è™¾éƒ½æ¯’æ­»ï¼ˆåå‘æ“ä½œï¼‰ï¼Œç»“æœè¢«å¥¹å·è¿›æ¼©æ¶¡æ´—äº†ä¸ªæ¾¡ã€‚", v_meet: "meet_5_to_6.wav", v_imp: "imp_5_to_6.wav" },
                7: { meet: "åªæœ‰é‚£ä¸ªä¹¦ç”Ÿèƒ½è®¤å‡ºæˆ‘æ‰€æœ‰çš„è‰è¯ã€‚æˆ‘å·äº†ä»–ä¸€æ ¹å¤´å‘åšå®éªŒï¼Œè¢«ä»–å‘ç°äº†ã€‚", imp: "å€¼å¾—å°Šæ•¬çš„å¯¹æ‰‹ã€‚è™½ç„¶ä»–æ€»æ˜¯è¯´æ•™ï¼Œä½†ä»–çš„çŸ¥è¯†ç¡®å®æ¸Šåšã€‚ä¸‹æ¬¡å·ä¸¤æ ¹å¤´å‘ã€‚", v_meet: "meet_5_to_7.wav", v_imp: "imp_5_to_7.wav" },
                8: { meet: "é‚£ä¸ªå§å§æƒ³æ•™æˆ‘åŒ»æœ¯æ•‘äººï¼Œæˆ‘æƒ³æ•™å¥¹æ¯’æœ¯æ€äººã€‚", imp: "å‡æ­£ç»ã€‚é•¿å¯¿æœ‰ä»€ä¹ˆç”¨ï¼Ÿå¦‚æœæ´»å¾—ç—›è‹¦ï¼Œä¸å¦‚å–ä¸‹æœ¬å°å§è¿™ç“¶æ¯’è¯æ¥å¾—ç—›å¿«ã€‚", v_meet: "meet_5_to_8.wav", v_imp: "imp_5_to_8.wav" },
                9: { meet: "æƒ³æŠ“å¥¹æ¥è¯•é£è¡Œè¯å‰‚ï¼Œç»“æœè¢«å¥¹å¸¦åˆ°å¤©ä¸Šæ‰”äº†ä¸‹æ¥ã€‚", imp: "é£å¾—å¿«äº†ä¸èµ·å•Šï¼Ÿç­‰æˆ‘ç ”åˆ¶å‡ºâ€œç¦ç©ºæ•£â€ï¼Œçœ‹ä½ æ‰ä¸æ‰ä¸‹æ¥ï¼", v_meet: "meet_5_to_9.wav", v_imp: "imp_5_to_9.wav" }
            } 
        } 
    },

    // --- 6. è ƒé±¼ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "yu-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 6, name: "è ƒé±¼", role: "è™šæ— ", type: "buff", color: "#00b0ff", 
        desc: "ç¾¤ä½“æ˜“ä¼¤ã€‚å¤§å¹…å‰Šå¼±æ•Œäººã€‚", 
        lines: { pick: "é è¿‘æˆ‘...ä¼šè¢«æ·¹æ²¡çš„...", idle: "å¬è§å¤§æµ·çš„å“­æ³£äº†å—ï¼Ÿ", s1: "æ°´å¼¹ï¼", s2: "çª’æ¯å§ï¼", ult: "å½’äºå¯‚é™ï¼" }, 
        skills:[ 
            {n:"æ°´å¼¹", c:0, val:1.4, gain:25, vfx:"yu-1", d:"[æ™®æ”»] 140%æ°´ä¼¤ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"æ´ªæ³¢", c:0, val:2.8, debuff:"vuln", gain:35, xp:25, vfx:"yu-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚280%æ°´ä¼¤+æ˜“ä¼¤ã€‚"}, 
            {n:"æµ·å•¸", c:100, val:5.5, debuff:"vuln_huge", xp:60, vfx:"yu-3", d:"[ç»ˆç»“æŠ€] 550%æ°´ä¼¤ï¼Œæ·±åº¦æ˜“ä¼¤(å—å‡»+100%)ï¼"} 
        ],
        story: { 
            bio: "<b>ã€æ‚²æ­Œã€‘</b> æˆ‘æœ‰ç€é¸Ÿçš„ç¿…è†€ï¼Œå´åªèƒ½æ´»åœ¨æ°´é‡Œï¼›æˆ‘æœ‰ç€é±¼çš„èº«ä½“ï¼Œå´æ¸´æœ›é£å‘å¤©ç©ºã€‚å‡¡äººå«æˆ‘ç¾æ˜Ÿï¼Œå› ä¸ºæˆ‘å‡ºç°çš„åœ°æ–¹ï¼Œå¿…æœ‰å¤§æ°´ã€‚<br><b>ã€å¿ƒæ„¿ã€‘</b> å…¶å®ï¼Œæˆ‘åªæ˜¯æƒ³é£å‡ºæ°´é¢ï¼Œçœ‹çœ‹å²¸ä¸Šçš„äººã€‚å¯æˆ‘æ¯ä¸€æ¬¡æŒ¥åŠ¨ç¿…è†€ï¼Œéƒ½ä¼šæ€èµ·æ»”å¤©å·¨æµªï¼Œæ·¹æ²¡æˆ‘æƒ³è¦äº²è¿‘çš„ä¸€åˆ‡ã€‚æˆ‘æ˜¯è¢«è¯…å’’çš„å°‘å¥³ã€‚", 
            bg: "é‚½å±±ï¼Œè’™æ°´å‡ºç„‰ã€‚å…¶ä¸­å¤šè ƒé±¼ï¼Œé±¼èº«è€Œé¸Ÿç¿¼ï¼ŒéŸ³å¦‚é¸³é¸¯ã€‚æˆ‘çš„å«å£°åƒé¸³é¸¯ä¸€æ ·åŠ¨å¬ï¼Œå´æ— äººæ•¢å¬ï¼Œå› ä¸ºé‚£æ„å‘³ç€æ¯ç­ã€‚", 
            voice: { bio: "story_6_bio.wav", bg: "story_6_bg.wav" }, 
            impressions: {
                1: { meet: "å¥¹æ›¾åœ¨æ°´è¾¹æ¢³æ´—ï¼Œé‚£ä¹ˆç¾ï¼Œé‚£ä¹ˆè€€çœ¼ã€‚æˆ‘çœ‹å‘†äº†ï¼Œå¿˜äº†æ§åˆ¶æ°´æµï¼Œç»“æœæŠŠå¥¹æ·‹æˆäº†è½æ±¤é¸¡ã€‚", imp: "å¥¹çš„ç«ï¼Œæ¸©æš–è€Œå±é™©ã€‚æˆ‘ç¾¡æ…•å¥¹çš„è‡ªä¿¡ï¼Œé‚£æ˜¯ç”Ÿæ´»åœ¨é˜³å…‰ä¸‹çš„äººæ‰æœ‰çš„å…‰èŠ’ã€‚", v_meet: "meet_6_to_1.wav", v_imp: "imp_6_to_1.wav" },
                2: { meet: "ä»–å¼ å¤§å˜´æ¥å–æ°´ï¼Œå·®ç‚¹æŠŠæˆ‘çš„å®¶å–å¹²äº†ï¼æˆ‘å“åäº†ï¼Œå¬å”¤æ¼©æ¶¡æŠŠä»–å·äº†è¿›å»ã€‚", imp: "ç²—é²çš„èƒ–å­ã€‚ä½†ä»–çœŸçš„å¾ˆå•çº¯ã€‚åªè¦ç»™ä»–é±¼åƒï¼Œä»–å°±ä¼šå†²æˆ‘ç¬‘ã€‚", v_meet: "meet_6_to_2.wav", v_imp: "imp_6_to_2.wav" },
                3: { meet: "ä»–æ˜¯æˆ‘çš„åŒä¹¡ã€‚ä½†ä»–å¤ªåµé—¹äº†ï¼Œæ•´å¤©å–Šæ‰“å–Šæ€ï¼Œç ´åäº†æ°´çš„å®é™ã€‚", imp: "ä»–æ€äººï¼Œæˆ‘å†²åˆ·å°¸ä½“ã€‚æˆ‘ä»¬å°±åƒæ˜¯æ¯ç­çš„ä¸Šä¸‹æ¸¸ã€‚è™½ç„¶ä¸å–œæ¬¢ä»–ï¼Œä½†åœ¨è¿™ä¸ªé™Œç”Ÿçš„é˜Ÿä¼é‡Œï¼Œä»–è®©æˆ‘æ„Ÿåˆ°ä¸€ä¸ç†Ÿæ‚‰ã€‚", v_meet: "meet_6_to_3.wav", v_imp: "imp_6_to_3.wav" },
                4: { meet: "æ´ªæ°´è¿‡åï¼Œåªæœ‰å¥¹ååœ¨æ ‘æ¢¢ä¸Šï¼Œé™ªæˆ‘çœ‹è¢«æ·¹æ²¡çš„ä¸–ç•Œã€‚", imp: "å”¯ä¸€ä¸è®¨åŒæˆ‘å¸¦æ¥æ´ªæ°´çš„äººã€‚åœ¨å¥¹èº«è¾¹ï¼Œæˆ‘è§‰å¾—è‡ªå·±ä¸æ˜¯ç¾æ˜Ÿï¼Œåªæ˜¯ä¸€æ¡æ™®é€šçš„é±¼ã€‚", v_meet: "meet_6_to_4.wav", v_imp: "imp_6_to_4.wav" },
                5: { meet: "å¥¹çš„è¯æ¸£æ±¡æŸ“äº†æ°´æºï¼Œå®³å¾—æˆ‘çš„ä¸€å®¶å°é±¼éƒ½ç”Ÿç—…äº†ã€‚", imp: "ä¹±æ‰”åƒåœ¾çš„å°è€é¼ ï¼è™½ç„¶å¥¹åæ¥é€äº†è§£è¯ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸æƒ³ç†å¥¹ã€‚", v_meet: "meet_6_to_5.wav", v_imp: "imp_6_to_5.wav" },
                7: { meet: "ä»–çŸ¥é“æˆ‘æ˜¯è ƒé±¼ï¼Œä¹ŸçŸ¥é“å¦‚ä½•æ²»æ°´ã€‚ä½†ä»–æ²¡æœ‰æ€æˆ‘ï¼Œåªæ˜¯å¹äº†å£æ°”ï¼ŒæŒ‡å¼•æˆ‘å»äº†å¤§æµ·ã€‚", imp: "åƒçˆ¶äº²ä¸€æ ·å¨ä¸¥è€Œæ…ˆæ‚²çš„é•¿è€…ã€‚æ˜¯ä»–å‘Šè¯‰æˆ‘ï¼Œåªè¦å¿ƒå­˜å–„å¿µï¼Œç¾æ˜Ÿä¹Ÿèƒ½å˜æˆå®ˆæŠ¤ç¥ã€‚", v_meet: "meet_6_to_7.wav", v_imp: "imp_6_to_7.wav" },
                8: { meet: "æ´ªæ°´æ³›æ»¥æ—¶ï¼Œå¥¹èƒŒç€å‡¡äººæ¸¡æ²³ï¼Œä¸€æ¬¡åˆä¸€æ¬¡ã€‚æˆ‘çœ‹ç€å¥¹ï¼Œé»˜é»˜å¹³æ¯äº†é£æµªã€‚", imp: "å¥¹çš„ç”Ÿå‘½åŠ›å¤ªæ—ºç››ï¼Œæ°´æ·¹ä¸æ­»å¥¹ã€‚å¥¹æ˜¯è¿™ä¸–é—´æ¸©æŸ”çš„å ¤åï¼Œé˜»æŒ¡ç€æˆ‘çš„æ‚²ä¼¤è”“å»¶ã€‚", v_meet: "meet_6_to_8.wav", v_imp: "imp_6_to_8.wav" },
                9: { meet: "æˆ‘åœ¨æ°´åº•æ¸¸ï¼Œå¥¹åœ¨å¤©ä¸Šé£ã€‚æˆ‘ä»¬éš”ç€æ°´é¢ç›¸æœ›ï¼Œé‚£æ˜¯ä¸¤ä¸ªæ°¸è¿œæ— æ³•è§¦ç¢°çš„ä¸–ç•Œã€‚", imp: "æˆ‘ç¾¡æ…•å¥¹çš„ç¿…è†€ï¼Œå¯ä»¥è‡ªç”±é£ç¿”ã€‚è€Œæˆ‘ï¼Œåªèƒ½å¸¦ç€è¿™åŒæ— ç”¨çš„ç¿…è†€æ²‰å…¥æ·±æ¸Šã€‚", v_meet: "meet_6_to_9.wav", v_imp: "imp_6_to_9.wav" }
            } 
        } 
    },

    // --- 7. ç™½æ³½ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "bai-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 7, name: "ç™½æ³½", role: "å­˜æŠ¤", type: "def", color: "#29b6f6", 
        desc: "å…¨é˜ŸæŠ¤ç›¾ã€‚ç»å¯¹é˜²å¾¡ã€‚", 
        lines: { pick: "å¤©å‘½æ‰€å½’ã€‚", idle: "çŸ¥æ™“ä¸€åˆ‡...", s1: "çœ‹ç ´ï¼", s2: "å¾¡ï¼", ult: "å¤©é“æ— æï¼Œç»å¯¹é˜²å¾¡ï¼" }, 
        skills:[ 
            {n:"æ´å¯Ÿ", c:0, val:1.3, gain:25, vfx:"bai-1", d:"[æ™®æ”»] 130%å†°ä¼¤ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"çµç›¾", c:0, val:0, shield:3500, gain:35, xp:25, vfx:"bai-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚å…¨é˜ŸæŠ¤ç›¾3500ã€‚"}, 
            {n:"å¤©çŸ¥", c:100, val:0, shield:15000, xp:60, vfx:"bai-3", d:"[ç»ˆç»“æŠ€] å…¨é˜Ÿè·å¾—15000ç‚¹ç¥ç›¾ï¼Œæ¸…é™¤æ‰€æœ‰è´Ÿé¢ï¼"} 
        ],
        story: { 
            bio: "<b>ã€é€šæ™“ã€‘</b> é€šä¸‡ç‰©ä¹‹æƒ…ï¼Œæ™“å¤©ä¸‹é¬¼ç¥ã€‚åœ¨ä¸‹ç™½æ³½ï¼Œæ´»å¾—å¤ªä¹…ï¼Œè§å¾—å¤ªå¤šã€‚å½“å¹´é»„å¸å·¡ç‹©ï¼Œæˆ‘çŒ®ä¸Šã€Šç™½æ³½å›¾ã€‹ï¼Œé“å°½äº†å¤©ä¸‹å¦–é¬¼çš„å¼±ç‚¹ã€‚<br><b>ã€ä»£ä»·ã€‘</b> å¦–æ—è§†æˆ‘ä¸ºå›å¾’ï¼Œäººæ—è§†æˆ‘ä¸ºå·¥å…·ã€‚çŸ¥æ™“ä¸€åˆ‡æ˜¯ä¸€ç§è¯…å’’ï¼Œä½†æˆ‘æ„¿ç”¨è¿™ä»½è¯…å’’ï¼Œä¸ºè‹ç”Ÿæ’‘èµ·ä¸€ç‰‡æœ€åçš„åº‡æŠ¤ä¹‹åœ°ã€‚", 
            bg: "ä¸œæµ·ä¹‹æ»¨ï¼Œé»„å¸å·¡ç‹©ï¼Œå¾—ç™½æ³½ç¥å…½ï¼Œèƒ½è¨€ï¼Œè¾¾äºä¸‡ç‰©ä¹‹æƒ…ã€‚æˆ‘æ˜¯æ™ºæ…§çš„è±¡å¾ï¼Œä¹Ÿæ˜¯å­¤ç‹¬çš„å®ˆæœ›è€…ã€‚", 
            voice: { bio: "story_7_bio.wav", bg: "story_7_bg.wav" }, 
            impressions: {
                1: { meet: "å½“å¹´å¥¹è¿˜æ˜¯ä¸€åªç‘Ÿç‘Ÿå‘æŠ–çš„å°é‡ç‹æ—¶ï¼Œé™©äº›è¢«å¤©é›·åŠˆæ­»ï¼Œæˆ‘æ›¾å‡ºæ‰‹æ•‘è¿‡å¥¹ã€‚", imp: "å¿ƒæœºå¤ªæ·±ï¼Œä½†å¥¹ä¹Ÿæœ‰å¥¹çš„è‹¦è¡·ã€‚å¥¹çœ¼åº•çš„å‡„å‡‰ï¼Œåœ¨ä¸‹çœ‹åœ¨çœ¼é‡Œã€‚åªè¦å¥¹ä¸åšå¾—å¤ªç»ï¼Œåœ¨ä¸‹ä¾¿è£…ä½œä¸çŸ¥å§ã€‚", v_meet: "meet_7_to_1.wav", v_imp: "imp_7_to_1.wav" },
                2: { meet: "æˆ‘æ›¾è¯•å›¾ç”¨çŸ¥è¯†å¡«æ»¡ä»–çš„èƒƒï¼Œç»™ä»–è®²äº†ä¸‰å¤©ä¸‰å¤œçš„é“ã€‚ç»“æœä»–ç¡ç€äº†ã€‚", imp: "æ¬²å£‘éš¾å¡«ã€‚ä»–æ˜¯ä¼—ç”Ÿè´ªå¿µçš„é›†åˆä½“ã€‚è™½ç„¶æ„šé’ï¼Œä½†è¿™ä»½å•çº¯çš„æ‰§ç€ï¼Œå€’ä¹Ÿéš¾å¾—ã€‚", v_meet: "meet_7_to_2.wav", v_imp: "imp_7_to_2.wav" },
                3: { meet: "ä»–ç¬¬ä¸€æ¬¡è§æˆ‘å°±æƒ³å’¬æˆ‘ï¼Œå› ä¸ºæˆ‘èº«ä¸Šæœ‰â€œç§©åºâ€çš„å‘³é“ã€‚", imp: "å†¥é¡½ä¸çµçš„å­½éšœã€‚ä»–ä¿¡å¥‰æ··ä¹±ï¼Œæˆ‘ç»´æŠ¤ç§©åºã€‚æˆ‘ä»¬æ³¨å®šæ— æ³•å…±å­˜ã€‚ä½†æˆ‘æœ‰æ—¶ä¹Ÿç¾¡æ…•ä»–çš„çº¯ç²¹ï¼Œæ´»å¾—æ— æ‹˜æ— æŸã€‚", v_meet: "meet_7_to_3.wav", v_imp: "imp_7_to_3.wav" },
                4: { meet: "ä¹±ä¸–ä¹‹ä¸­ï¼Œæˆ‘å‘ç°è¿™å­©å­åœ¨åºŸå¢Ÿä¸Šå”±æ­Œï¼Œå‘¨å›´çš„æ€¨çµç«Ÿç„¶éƒ½æ•£å»äº†ã€‚", imp: "æˆ‘æŠŠå¥¹è®°åœ¨ã€Šç™½æ³½å›¾ã€‹çš„ç¬¬ä¸€é¡µï¼Œæ ‡æ³¨ä¸ºâ€œä¸å¯ä¼¤å®³â€ã€‚å¥¹æ˜¯è¿™æ®‹é…·ä¸–ç•Œé‡Œå”¯ä¸€çš„æ…°è—‰ï¼Œæ„¿ä¸–ç•Œå¯¹å¥¹æ¸©æŸ”ä»¥å¾…ã€‚", v_meet: "meet_7_to_4.wav", v_imp: "imp_7_to_4.wav" },
                5: { meet: "å¥¹æ¥å·æˆ‘çš„åŒ»ä¹¦ï¼Œè¢«æˆ‘å½“åœºæŠ“è·ã€‚æˆ‘æ²¡æœ‰ç½šå¥¹ï¼Œåè€Œæ•™äº†å¥¹å‡ å‘³è¯ç†ã€‚", imp: "å°èªæ˜ã€‚ç”¨è¯ç†å»å®³äººï¼Œç»ˆç©¶æ˜¯è½äº†ä¸‹ä¹˜ã€‚å¸Œæœ›èƒ½æœ‰äººå¼•é‚£ä¸«å¤´èµ°ä¸Šæ­£é€”ã€‚", v_meet: "meet_7_to_5.wav", v_imp: "imp_7_to_5.wav" },
                6: { meet: "å¥¹å› ä¸ºæ§åˆ¶ä¸ä½æ´ªæ°´è€Œæƒ³è¦è‡ªæ€ã€‚æˆ‘æ‹¦ä½äº†å¥¹ã€‚", imp: "ä¹Ÿæ˜¯ä¸ªå¯æ€œäººï¼Œè¢«å¤©æ€§æ‰€å›°ã€‚å¥¹æœ¬æ€§å–„è‰¯ï¼Œåªæ˜¯èƒŒè´Ÿäº†å¤ªæ²‰é‡çš„å®¿å‘½ã€‚æˆ‘æ„¿ä¸ºå¥¹æŒ‡å¼•æ–¹å‘ã€‚", v_meet: "meet_7_to_6.wav", v_imp: "imp_7_to_6.wav" },
                8: { meet: "æˆ‘ä»¬åœ¨ä¸œæµ·è¾¹ç›¸é‡ï¼Œå¯¹åäº†ä¸‰å¤©ä¸‰å¤œï¼Œä¸€å¥è¯æ²¡è¯´ï¼Œå´ä»¿ä½›è¯´å°½äº†æ²§æ¡‘ã€‚", imp: "ä¹˜é»„å¥³å£«ï¼Œä½ ä¹Ÿç´¯äº†å§ï¼Ÿæˆ‘ä»¬éƒ½èƒŒè´Ÿç€å¤ªæ²‰é‡çš„ä¸œè¥¿â€”â€”æˆ‘æ˜¯çŸ¥è¯†ï¼Œå¥¹æ˜¯å¯¿å‘½ã€‚åªæœ‰å’Œå¥¹å¯¹é¥®æ—¶ï¼Œæˆ‘æ‰èƒ½çœŸæ­£æ”¾æ¾ã€‚", v_meet: "meet_7_to_8.wav", v_imp: "imp_7_to_8.wav" },
                9: { meet: "è¥¿ç‹æ¯æ´¾å¥¹æ¥ç»™æˆ‘é€ä¿¡ï¼Œå¥¹å½å½å–³å–³åœ°è®²äº†ä¸€è·¯çš„è§é—»ï¼Œåµå¾—æˆ‘å¤´ç–¼ã€‚", imp: "æ´»æ³¼çš„å°ä¸«å¤´ã€‚å¥¹æ€»æ˜¯å¸¦æ¥æœ€æ–°çš„å…«å¦æ¶ˆæ¯ï¼Œæ˜¯æˆ‘äº†è§£è¿™ä¸ªä¸–ç•Œå˜åŒ–çš„å”¯ä¸€çª—å£ã€‚", v_meet: "meet_7_to_9.wav", v_imp: "imp_7_to_9.wav" }
            } 
        } 
    },

    // --- 8. ä¹˜é»„ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "cheng-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 8, name: "ä¹˜é»„", role: "ä¸°é¥¶", type: "def", color: "#66bb6a", 
        desc: "æ€¥æ•‘æ²»ç–—ã€‚ç¬é—´æŠ¬è¡€ã€‚", 
        lines: { pick: "æŠ¤ä½ å‘¨å…¨ã€‚", idle: "ç”Ÿå‘½...", s1: "èµ°å¼€ï¼", s2: "æ„¿å¹³å®‰å–œä¹ã€‚", ult: "æ¯æœ¨é€¢æ˜¥ï¼" }, 
        skills:[ 
            {n:"çµå‡»", c:0, val:1.3, gain:25, vfx:"cheng-1", d:"[æ™®æ”»] 130%ä¼¤å®³ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"ç¥ˆç¦", c:0, val:0, heal:5000, gain:35, xp:25, vfx:"cheng-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚å•ä½“å¤§å¥¶ï¼Œå›5000è¡€ã€‚"}, 
            {n:"ç¥è¿¹", c:110, val:0, heal:20000, xp:60, vfx:"cheng-3", d:"[ç»ˆç»“æŠ€] å…¨é˜Ÿå›20000è¡€ï¼èµ·æ­»å›ç”Ÿã€‚"} 
        ],
        story: { 
            bio: "<b>ã€è¯…å’’ã€‘</b> éª‘ä¸Šæˆ‘çš„äººï¼Œå¯æ´»ä¸¤åƒå²ã€‚å‡¡äººä¸ºäº†è¿™ä»½å¯¿å‘½ï¼Œä¸æƒœäº’ç›¸æ®‹æ€ï¼Œç”šè‡³æŠŠåˆ€æ¶åœ¨æˆ‘çš„è„–å­ä¸Šã€‚æˆ‘çš„è¡€ï¼Œæˆäº†ä»–ä»¬çœ¼ä¸­çš„é•¿ç”Ÿè¯ã€‚<br><b>ã€è§‰æ‚Ÿã€‘</b> æˆ‘çœ‹å°½äº†äººæ€§çš„ä¸‘æ¶ï¼Œä¹Ÿè§è¿‡äº†ç”Ÿç¦»æ­»åˆ«ã€‚æˆ‘ç»ˆäºæ˜ç™½ï¼Œç”Ÿå‘½çš„æ„ä¹‰ä¸åœ¨é•¿åº¦ï¼Œè€Œåœ¨åšåº¦ã€‚ç°åœ¨ï¼Œæˆ‘ä¸å†æ˜¯é€ƒè·‘çš„çŒç‰©ï¼Œæˆ‘è¦ç”¨æˆ‘çš„è§’ï¼Œå»æ²»æ„ˆé‚£äº›çœŸæ­£å€¼å¾—æ•‘çš„äººã€‚", 
            bg: "ç™½æ°‘ä¹‹å›½ï¼Œæœ‰ä¹˜é»„ï¼Œå…¶çŠ¶å¦‚ç‹ï¼Œå…¶èƒŒä¸Šæœ‰è§’ï¼Œä¹˜ä¹‹å¯¿äºŒåƒå²ã€‚é•¿ç”Ÿæ˜¯ä¸–äººçš„æ¢¦æƒ³ï¼Œå´æ˜¯æˆ‘èƒŒè´Ÿçš„æ·é”ã€‚", 
            voice: { bio: "story_8_bio.wav", bg: "story_8_bg.wav" }, 
            impressions: {
                1: { meet: "å¥¹æ›¾æƒ³é­…æƒ‘æˆ‘ï¼Œè®©æˆ‘å¸¦å¥¹é•¿ç”Ÿã€‚æˆ‘çœ‹ç€å¥¹çš„çœ¼ç›è¯´ï¼šâ€œé•¿ç”Ÿå¾ˆè‹¦çš„ï¼Œä½ å—å¾—äº†å—ï¼Ÿâ€", imp: "å¥¹çš„ç¾è²Œèƒ½ç»´æŒåƒå¹´ï¼Œä½†å¥¹çš„å¿ƒå·²ç»åƒç–®ç™¾å­”äº†ã€‚æˆ‘æ›¾æƒ³æ²»æ„ˆå¥¹çš„å¿ƒç—…ï¼Œä½†å¥¹æ‹’ç»äº†ã€‚å¥¹è¯´æ²¡æœ‰äº†ç—›ï¼Œå°±å¿˜äº†è‡ªå·±æ˜¯è°ã€‚", v_meet: "meet_8_to_1.wav", v_imp: "imp_8_to_1.wav" },
                2: { meet: "ä»–æƒ³åƒæˆ‘ï¼Œä¸æ˜¯ä¸ºäº†é•¿ç”Ÿï¼Œåªæ˜¯å› ä¸ºé¥¿ã€‚æˆ‘ç»™äº†ä»–å¾ˆå¤šé£Ÿç‰©ï¼Œå‘Šè¯‰ä»–â€œæ´»ç€ä¸æ˜¯ä¸ºäº†åƒâ€ã€‚", imp: "å•çº¯çš„å‚»å¤§ä¸ªã€‚æœ‰æ—¶å€™æˆ‘ä¹Ÿæƒ³åƒä»–ä¸€æ ·ï¼Œåªä¸ºäº†å¡«é¥±è‚šå­è€Œæ´»ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šçƒ¦æ¼ã€‚", v_meet: "meet_8_to_2.wav", v_imp: "imp_8_to_2.wav" },
                3: { meet: "ä»–é€ æˆçš„ä¼¤å£å¾ˆéš¾æ„ˆåˆï¼Œé‚£æ˜¯å¸¦ç€è¯…å’’çš„ä¼¤ã€‚æˆ‘å¿…é¡»èŠ±è´¹åŒå€çš„çµåŠ›å»æ²»æ„ˆã€‚", imp: "åˆ¶é€ ä¼¤ç—›çš„æ¶å¾’ã€‚ä½†ä»–ä¹Ÿæ˜¯ä¸€ç§â€œå¿…è¦ä¹‹æ¶â€å§ï¼Ÿæ²¡æœ‰ä»–çš„ç ´åï¼Œä¸–äººæ€çŸ¥ç”Ÿå‘½çš„çè´µï¼Ÿ", v_meet: "meet_8_to_3.wav", v_imp: "imp_8_to_3.wav" },
                4: { meet: "åªè¦å¥¹åœ¨ï¼Œæˆ‘å°±ä¸éœ€è¦æ–½å±•æ²»ç–—æœ¯ã€‚å¿«ä¹æ˜¯æœ€å¥½çš„è¯ã€‚", imp: "å¤šä¹ˆçº¯å‡€çš„çµé­‚ï¼Œå¸Œæœ›å²æœˆä¸è¦ç£¨å¹³äº†å¥¹çš„æ£±è§’ã€‚å¦‚æœå¯ä»¥ï¼Œæˆ‘æƒ³æŠ¤å¥¹å‘¨å…¨ã€‚", v_meet: "meet_8_to_4.wav", v_imp: "imp_8_to_4.wav" },
                5: { meet: "æˆ‘ä»¬æ›¾æ•´å¤œæ¢è®¨è‰è¯ã€‚è™½ç„¶å¥¹ç ”ç©¶çš„æ˜¯æ€ä¹ˆæ¯’æ­»äººï¼Œæˆ‘ç ”ç©¶çš„æ˜¯æ€ä¹ˆæ•‘äººã€‚", imp: "ç”¨æ¯’ä¹‹äººï¼Œäº¦æ‡‚åŒ»ç†ã€‚åªè¦é‚£ä¸ªå°å¦¹å¦¹ä¸ç”¨æ¯’å®³äººï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ˜¯æœ‹å‹ã€‚", v_meet: "meet_8_to_5.wav", v_imp: "imp_8_to_5.wav" },
                6: { meet: "æ´ªæ°´è¿‡åï¼Œå¿…æœ‰ç˜Ÿç–«ã€‚é‚£æ˜¯æˆ‘æœ€å¿™çš„æ—¶å€™ã€‚æˆ‘çœ‹åˆ°å¥¹åœ¨è§’è½é‡Œå“­æ³£ï¼Œä¾¿èµ°è¿‡å»ç»™äº†å¥¹ä¸€é¢—èƒ½å®‰ç¥çš„è‰è¯ã€‚", imp: "æˆ‘ä¸æ€ªå¥¹ï¼Œç¾éš¾ä¹Ÿæ˜¯è‡ªç„¶å¾ªç¯çš„ä¸€éƒ¨åˆ†ã€‚å¥¹è´Ÿè´£ç ´åï¼Œæˆ‘è´Ÿè´£ä¿®è¡¥ã€‚è¿™æ˜¯æˆ‘ä»¬çš„å®¿å‘½ã€‚", v_meet: "meet_8_to_6.wav", v_imp: "imp_8_to_6.wav" },
                7: { meet: "ç™½æ³½å…ˆç”Ÿï¼Œæˆ‘ä»¬æ˜¯åŒç±»ã€‚æˆ‘ä»¬ç»å¸¸ä¸€èµ·ä¸‹æ£‹ã€‚ä»–é€šæ™“æœªæ¥ï¼Œæˆ‘ä¸æ±‚é•¿ç”Ÿï¼Œåªäº‰æ£‹ç›˜ä¸Šçš„ä¸€æ—¶èƒœè´Ÿã€‚", imp: "å”¯ä¸€çš„çŸ¥å·±ã€‚åœ¨è¿™ä¸ªç–¯ç‹‚çš„ä¸–ç•Œé‡Œï¼Œåªæœ‰å’Œä»–åœ¨ä¸€èµ·ï¼Œæˆ‘æ‰èƒ½æ„Ÿåˆ°ç‰‡åˆ»çš„å®‰å®ã€‚", v_meet: "meet_8_to_7.wav", v_imp: "imp_8_to_7.wav" },
                9: { meet: "å¥¹å—ä¼¤æ—¶ä»ä¸å–Šç–¼ï¼Œåªæ€•é£ä¸èµ·æ¥ã€‚æˆ‘æ²»å¥½äº†å¥¹çš„ç¿…è†€ï¼Œå¥¹é€äº†æˆ‘ä¸€ç‰‡æœ€è“çš„ç¾½æ¯›ã€‚", imp: "å……æ»¡æ´»åŠ›çš„ç”Ÿå‘½ï¼Œçœ‹ç€å¥¹ï¼Œæˆ‘å°±è§‰å¾—è‡ªå·±å¹´è½»äº†ã€‚å¸Œæœ›å¥¹èƒ½æ°¸è¿œè‡ªç”±åœ°é£ç¿”ã€‚", v_meet: "meet_8_to_9.wav", v_imp: "imp_8_to_9.wav" }
            } 
        } 
    },

    // --- 9. é’é¸Ÿ (ä¿ç•™äº†ç‰¹æ•ˆç‰ˆçš„ vfx: "qing-1" å’Œé«˜æ•°å€¼) ---
    { 
        id: 9, name: "é’é¸Ÿ", role: "åŒè°", type: "def", color: "#26c6da", 
        desc: "å…¨é˜Ÿå……èƒ½ã€‚é€Ÿåº¦æå‡ã€‚", 
        lines: { pick: "ä½¿å‘½å¿…è¾¾ï¼", idle: "æœ‰ä¿¡ä»¶å“¦~", s1: "é£åˆƒï¼", s2: "åŠ æ€¥ï¼", ult: "é£å•Šï¼ŒæŒ‡å¼•æˆ‘ä»¬ï¼" }, 
        skills:[ 
            {n:"é£ç¾½", c:0, val:1.5, gain:25, vfx:"qing-1", d:"[æ™®æ”»] 150%é£ä¼¤ï¼Œå›1æˆ˜æŠ€ç‚¹ã€‚"}, 
            {n:"ä¼ ä¿¡", c:0, val:0, mp_up:true, heal:2000, gain:35, xp:25, vfx:"qing-2", d:"[æˆ˜æŠ€] æ¶ˆè€—1ç‚¹ã€‚å…¨é˜Ÿå›èƒ½30+å›è¡€2000ã€‚"}, 
            {n:"è“¬å±±", c:100, val:0, mp_all:true, xp:60, vfx:"qing-3", d:"[ç»ˆç»“æŠ€] å…¨é˜Ÿå……èƒ½ã€å›æ»¡ã€‘ï¼ç«‹å³çˆ†å‘ã€‚"} 
        ],
        story: { 
            bio: "<b>ã€ä½¿å‘½ã€‘</b> æˆ‘æ˜¯è¥¿ç‹æ¯çš„ä¿¡ä½¿ï¼Œæ°¸è¿œå¥”æ³¢åœ¨è·¯ä¸Šã€‚æˆ‘è§è¿‡æ˜†ä»‘çš„é›ªï¼Œä¹Ÿè§è¿‡ä¸œæµ·çš„æµªã€‚æˆ‘çš„ç¿…è†€å±äºå¤©ç©ºï¼Œæˆ‘çš„ä½¿å‘½æ˜¯è¿æ¥æ€å¿µã€‚<br><b>ã€è‡ªç”±ã€‘</b> æœ‰äººè¯´æˆ‘æ˜¯ä»†äººï¼Œä¸ï¼Œæˆ‘æ˜¯é£çš„å® å„¿ï¼åªè¦ä½ å‘¼å”¤ï¼Œæˆ‘å°±ä¼šä¹˜é£è€Œæ¥ï¼æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æŒ¡æˆ‘é€ä¿¡çš„è„šæ­¥ï¼æˆ‘æƒ³æŠŠè¿™ä¸–é—´æœ€ç¾å¥½çš„æ¶ˆæ¯ï¼Œå¸¦ç»™æ¯ä¸€ä¸ªäººï¼", 
            bg: "è¥¿ç‹æ¯æ¢¯å‡ ï¼Œè€Œæˆ´èƒœã€‚å…¶å—æœ‰ä¸‰é’é¸Ÿï¼Œä¸ºè¥¿ç‹æ¯å–é£Ÿã€‚æˆ‘æ˜¯ç¥æ˜çš„ä¿¡ä½¿ï¼Œä¼ é€’ç€æ—¨æ„ä¸äººé—´çš„ç›¸æ€ã€‚", 
            voice: { bio: "story_9_bio.wav", bg: "story_9_bg.wav" }, 
            impressions: {
                1: { meet: "å¥¹æ€»æ˜¯å¯„ä¸€äº›æ²¡æœ‰æ”¶ä»¶äººçš„ä¿¡ï¼Œä¿¡ä¸Šåªæœ‰æ³ªç—•ã€‚æˆ‘é—®å¥¹å¯„ç»™è°ï¼Œå¥¹è®©æˆ‘æŠŠä¿¡çƒ§äº†ã€‚", imp: "èº«ä¸Šæ€»æ˜¯æœ‰è‚¡å¥½é—»çš„é¦™ç²‰å‘³ã€‚è™½ç„¶å¥¹æ€»æ˜¯å‡¶å·´å·´çš„ï¼Œä½†æˆ‘çŸ¥é“å¥¹å¿ƒé‡Œå…¶å®å¾ˆæ¸´æœ›æ”¶åˆ°å›ä¿¡ã€‚", v_meet: "meet_9_to_1.wav", v_imp: "imp_9_to_1.wav" },
                2: { meet: "æœ‰æ¬¡æˆ‘é£ç´¯äº†åœåœ¨ä»–èƒŒä¸Šä¼‘æ¯ï¼Œä»–ä»¥ä¸ºæˆ‘æ˜¯å¤§èšŠå­ï¼Œæ‹äº†è‡ªå·±ä¸€å·´æŒã€‚", imp: "åªä¼šåƒçš„ç¬¨è›‹ã€‚ä½†ä»–çœŸçš„å¾ˆæš–å’Œï¼Œå†¬å¤©é åœ¨ä»–èº«ä¸Šç¡è§‰æœ€èˆ’æœäº†ã€‚", v_meet: "meet_9_to_2.wav", v_imp: "imp_9_to_2.wav" },
                3: { meet: "ä»–æƒ³æ‹¦æˆªæˆ‘çš„ä¿¡ä»¶ï¼Œçœ‹çœ‹é‡Œé¢æœ‰æ²¡æœ‰æ•Œæƒ…ã€‚æˆ‘åˆ©ç”¨äº‘å±‚å’Œä»–ç©èµ·äº†æ‰è¿·è—ã€‚", imp: "å‡¶ç¥æ¶ç…çš„ï¼Œä½†æˆ‘é£å¾—æ¯”ä»–é«˜ï¼Œä»–ä¸æ€•ã€‚è€Œä¸”ä»–å…¶å®æŒºå®ˆä¿¡ç”¨çš„ï¼Œè¯´ä¸æŠ“æˆ‘å°±çœŸçš„ä¸æŠ“äº†ã€‚", v_meet: "meet_9_to_3.wav", v_imp: "imp_9_to_3.wav" },
                4: { meet: "æ¯æ¬¡æˆ‘ä¸å¼€å¿ƒï¼Œå°±å»æ‰¾å¥¹è¹­è¹­ã€‚å¥¹å°±åƒä¸ªå……ç”µå®ï¼ŒæŠ±ä¸€ä¸‹å°±ç²¾ç¥äº†ã€‚", imp: "ä¸–ç•Œä¸Šæœ€å¯çˆ±çš„å°ä¸œè¥¿ï¼çœ‹åˆ°å¥¹ï¼Œæˆ‘å°±è§‰å¾—é€ä¿¡çš„ç–²æƒ«éƒ½æ¶ˆå¤±äº†ã€‚", v_meet: "meet_9_to_4.wav", v_imp: "imp_9_to_4.wav" },
                5: { meet: "å¥¹æƒ³ç»™æˆ‘ä¸‹æ¯’ï¼Œè¢«æˆ‘ä¸€ç¿…è†€æ‰‡é£äº†ã€‚æˆ‘çš„é£å¯æ˜¯èƒ½å¹æ•£æ¯’æ°”çš„ï¼", imp: "é˜´æ£®æ£®çš„è€é¼ ï¼Œç¦»æˆ‘è¿œç‚¹ã€‚ä½†å¥¹åšçš„ä¼¤è¯ç¡®å®æŒºå¥½ç”¨çš„ï¼Œå°±æ˜¯å‘³é“å¤ªè‡­ã€‚", v_meet: "meet_9_to_5.wav", v_imp: "imp_9_to_5.wav" },
                6: { meet: "æˆ‘åœ¨å¤©ä¸Šçœ‹åˆ°å¥¹å­¤ç‹¬åœ°æ¸¸åœ¨æ°´é‡Œï¼Œå°±ç»™å¥¹æ‰”äº†ä¸€é¢—æ¥è‡ªæ˜†ä»‘å±±çš„å®çŸ³ã€‚", imp: "é‚£å®¶ä¼™æ€»æ˜¯é˜´æ²‰æ²‰çš„ã€‚çœŸæƒ³å¸¦å¥¹å»äº‘å±‚ä¹‹ä¸Šæ™’æ™’å¤ªé˜³ï¼Œä¹Ÿè®¸å¥¹å°±ä¸ä¼šé‚£ä¹ˆæƒ³å‘å¤§æ°´äº†ã€‚", v_meet: "meet_9_to_6.wav", v_imp: "imp_9_to_6.wav" },
                7: { meet: "æ¯æ¬¡é€ä¿¡ç»™ä»–ï¼Œä»–éƒ½è¦æ‹‰ç€æˆ‘é—®ä¸œé—®è¥¿ï¼Œè¿˜è€ƒæˆ‘åœ°ç†çŸ¥è¯†ã€‚", imp: "å•°å—¦çš„å…ˆç”Ÿï¼Œåƒæˆ‘çˆ·çˆ·ä¸€æ ·ã€‚ä½†ä»–ç»™çš„é›¶é£Ÿå¾ˆå¥½åƒï¼Œæˆ‘å°±å‹‰å¼ºå¬ä»–å” å¨ä¸¤å¥å§ã€‚", v_meet: "meet_9_to_7.wav", v_imp: "imp_9_to_7.wav" },
                8: { meet: "æˆ‘çš„ç¿…è†€å—äº†ä¼¤ï¼Œæ˜¯å¥¹ä¸€ç‚¹ç‚¹å¸®æˆ‘æ²»å¥½çš„ã€‚å¥¹åŠ¨ä½œå¾ˆè½»ï¼Œç”Ÿæ€•å¼„ç–¼äº†æˆ‘ã€‚", imp: "è®©äººå®‰å¿ƒçš„å§å§ã€‚åªè¦æœ‰å¥¹åœ¨é˜Ÿä¼é‡Œï¼Œæˆ‘å°±æ•¢é£å¾—æ›´å¿«ã€æ›´è¿œï¼Œå› ä¸ºæˆ‘çŸ¥é“æ— è®ºå—å¤šé‡çš„ä¼¤ï¼Œå¥¹éƒ½èƒ½æ²»å¥½æˆ‘ã€‚", v_meet: "meet_9_to_8.wav", v_imp: "imp_9_to_8.wav" }
            } 
        } 
    }
];

// ==========================================
// 2. BOSSæ•°æ® (æ•°å€¼å¹³è¡¡)
// ==========================================
const LEVELS = [
    // 1. ç‹Œç‹Œ
    { 
        n: "ç‹Œç‹Œ", hp: 4500, atk: 350, img: "images/boss_1.png", 
        voice: {start:"boss_1_start.wav", half:"boss_1_half.wav", dead:"boss_1_dead.wav"},
        lines: { start: "ç»†çš®å«©è‚‰çš„å°ä¸œè¥¿...", half: "å¼â€”â€”ï¼ï¼", dead: "åŠ›é‡...æ¯ç«­äº†..." },
        moves: [
            {n:"è›®åŠ›æŒ¥æ‹³", p:50, val:1.0, txt:"æŒ¥èˆé‡æ‹³ï¼", type:"tao-1"}, 
            {n:"é‡æ€§å’†å“®", p:30, val:0.3, debuff:"vuln", txt:"å‘å‡ºéœ‡æ…‘å’†å“®ï¼", type:"qing-2"},
            {n:"å·¨çŸ³æŠ•æ·", p:20, val:1.8, txt:"ç ¸å‘ä½ ï¼", type:"tao-2"}
        ]
    },
    // 2. å¸æ±Ÿ
    { 
        n: "å¸æ±Ÿ", hp: 8500, atk: 550, img: "images/boss_2.png", 
        voice: {start:"boss_2_start.wav", half:"boss_2_half.wav", dead:"boss_2_dead.wav"},
        lines: { start: "å›å½’...æ··æ²Œ...", half: "ç§©åº...å´©å¡Œ...", dead: "æ•£ä½œ...è™šæ— ..." },
        moves: [
            {n:"æ··æ²Œä¹‹è§¦", p:40, val:1.0, dot:400, txt:"ä¼¸å‡ºè§¦æ‰‹...", type:"tao-2"}, 
            {n:"ç©ºé—´éœ‡è¡", p:30, val:1.6, txt:"æ’•è£‚ç©ºé—´ï¼", type:"bai-2"},
            {n:"è™šæ— åå™¬", p:30, val:0.8, heal:1000, txt:"æ±²å–ç”Ÿå‘½...", type:"fox-3"}
        ]
    },
    // 3. çƒ›é¾™
    { 
        n: "çƒ›é¾™", hp: 15000, atk: 750, img: "images/boss_3.png", 
        voice: {start:"boss_3_start.wav", half:"boss_3_half.wav", dead:"boss_3_dead.wav"},
        lines: { start: "ç›´è§†å²æœˆçš„å°½å¤´ï¼Ÿ", half: "å¾...æ°¸æ’ä¸ç­ã€‚", dead: "æ—¶é—´...ç»ˆç»“..." },
        moves: [
            {n:"æ—¶å…‰å‡è§†", p:40, val:1.4, txt:"å‡è§†çµé­‚ï¼", type:"fei-3"},
            {n:"æ˜¼å¤œé€†è½¬", p:30, val:0, buff:"atk", txt:"å¤©ç«é™ä¸´ï¼", type:"fox-3"}, 
            {n:"å²æœˆä¾µèš€", p:30, val:2.5, txt:"å‰¥å¤ºå¯¿å‘½ï¼", type:"shu-2"} 
        ]
    },
    // 4. ç›¸æŸ³
    { 
        n: "ç›¸æŸ³", hp: 24000, atk: 950, img: "images/boss_4.png", 
        voice: {start:"boss_4_start.wav", half:"boss_4_half.wav", dead:"boss_4_dead.wav"},
        lines: { start: "çš†ä¸ºæ³½å›½...", half: "æ–©æ‰ä¸€ä¸ªå¤´è¿˜æœ‰å…«ä¸ª...", dead: "ä¸å¯èƒ½..." },
        moves: [
            {n:"ä¹é¦–é½æ”»", p:40, val:1.3, txt:"ä¹å¤´é½å’¬ï¼", type:"qiong-1"}, 
            {n:"å‰§æ¯’æ²¼æ³½", p:30, val:0.7, dot:600, txt:"è…èš€å¤§åœ°ï¼", type:"shu-2"}, 
            {n:"è…¥é£è¡€é›¨", p:30, val:2.0, debuff:"vuln", txt:"è…¥è‡­é£æš´ï¼", type:"yu-3"} 
        ]
    },
    // 5. åˆ‘å¤©
    {
        n: "åˆ‘å¤©", hp: 36000, atk: 1300, img: "images/boss_5.png", 
        voice: {start:"boss_5_start.wav", half:"boss_5_half.wav", dead:"boss_5_dead.wav"},
        lines: { start: "æˆ˜é­‚...æ°¸ä¸ç†„ç­ï¼", half: "ç—›å¿«ï¼ç—›å¿«ï¼", dead: "æ„å¿—...é•¿å­˜ï¼" },
        moves: [
            {n:"å¹²æˆšä¹‹èˆ", p:50, val:1.5, txt:"æŒ¥èˆå·¨æ–§ï¼", type:"qiong-3"},
            {n:"çŒ›ç›¾é‡å‡»", p:30, val:3.2, txt:"ç ¸ç¢éª¨å¤´ï¼", type:"tao-2"}, 
            {n:"ä¸å±ˆæ„å¿—", p:20, val:0, shield:6000, txt:"åŒ–ä¸ºåšç›¾ï¼", type:"bai-2"} 
        ]
    },
    // 6. èš©å°¤
    {
        n: "èš©å°¤", hp: 52000, atk: 1600, img: "images/boss_6.png", 
        voice: {start:"boss_6_start.wav", half:"boss_6_half.wav", dead:"boss_6_dead.wav"},
        lines: { start: "å¾ä¹ƒå…µä¸»ï¼", half: "å€¼å¾—æˆ‘æ‹”å‰‘...", dead: "æˆ˜æ„...æµä¼ ..." },
        moves: [
            {n:"å…µæˆˆä¹±èˆ", p:40, val:2.0, txt:"ä¸‡åƒå…µåˆƒï¼", type:"qiong-3"},
            {n:"é­”ç¥é™ä¸´", p:30, val:4.5, txt:"å¤©åœ°å˜è‰²ï¼", type:"tao-3"},
            {n:"å¤§é›¾å¼¥æ¼«", p:30, val:0, debuff:"vuln", txt:"å”¤èµ·è¿·é›¾...", type:"shu-2"}
        ]
    }
];
const XP_MAX = [100, 300, 9999];

// ==========================================
// 3. è§†è§‰ç‰¹æ•ˆç³»ç»Ÿ (VFX)
// ==========================================
const VFX = {
    trigger(targetEl, type, color) {
        if (!targetEl) return;
        const rect = targetEl.getBoundingClientRect();
        const node = document.createElement('div');
        node.className = `vfx-base vfx-${type}`; 
        node.style.left = (rect.left + rect.width/2) + 'px';
        node.style.top = (rect.top + rect.height/2) + 'px';
        document.body.appendChild(node);
        setTimeout(() => node.remove(), 1500); // å»¶é•¿æ¶ˆé™¤æ—¶é—´ä»¥é€‚åº”é•¿åŠ¨ç”»
    },
    impact(target, type, color) { this.trigger(target, type, color); },
    ultScreen(color) {
        const s = document.getElementById('vfx-screen');
        if(s) { s.style.backgroundColor = color; s.style.opacity = 0.5; setTimeout(() => s.style.opacity = 0, 400); }
        const app = document.getElementById('game-app'); app.classList.remove('ult-shake'); void app.offsetWidth; app.classList.add('ult-shake');
    },
    floatNum(el, val, type="normal") {
        if(!el) return;
        const d = document.createElement('div'); d.className = 'float-num';
        if (type === 'crit') { d.innerText = `ğŸ’¥ ${val}!`; d.className += ' dmg-crit'; }
        else if (type === 'heal') { d.innerText = `+${val}`; d.className += ' dmg-heal'; }
        else { d.innerText = `${val}`; d.className += ' dmg-normal'; }
        const rect = el.getBoundingClientRect();
        const rndX = (Math.random() - 0.5) * 80;
        d.style.left = (rect.left + rect.width/2 + rndX) + 'px';
        d.style.top = (rect.top + rect.height/3) + 'px';
        document.body.appendChild(d); setTimeout(() => d.remove(), 1000);
    }
};

// ==========================================
// 4. æ¸¸æˆæ ¸å¿ƒé€»è¾‘
// ==========================================
window.Game = {
    sp: 3, maxSp: 5, round: 1, deck: [], hand: [], lvl: 0,
    p: {hp:0, max:0, shield:0, buffs:[]}, e: {hp:0, max:0, dot:0, stun:false, debuffs:[], saidHalf:false}, 
    turnLocked: false, currentActor: 0, currentVoice: null, voiceVol: 0.8, upgrades: {}, 

    playVoice(id, type, customSrc = null) {
        const folder = 'audio/';
        let fileName = customSrc ? customSrc : (id === 'boss' ? type : `v_${id}_${type}.wav`);
        let src = folder + fileName;
        if (this.currentVoice) { this.currentVoice.pause(); this.currentVoice.currentTime = 0; }
        const audio = new Audio(src); audio.volume = this.voiceVol; 
        audio.play().catch((e) => { if (src.endsWith('.wav')) { new Audio(src.replace('.wav', '.mp3')).play().catch(()=>{}); } });
        this.currentVoice = audio;
    },
    stopVoice() { if (this.currentVoice) { this.currentVoice.pause(); this.currentVoice.currentTime = 0; this.currentVoice = null; } },
    shakeScreen() { document.getElementById('game-app').classList.remove('shake-screen'); void document.getElementById('game-app').offsetWidth; document.getElementById('game-app').classList.add('shake-screen'); },
init() { const resize = () => { document.getElementById('scale-wrapper').style.transform = `scale(${Math.min(window.innerWidth/1920, window.innerHeight/1080)})`; }; window.onresize = resize; resize(); this.checkSave(); },
    checkSave() { try { const s = localStorage.getItem('shanhai_v7'); if(s) { const d = JSON.parse(s); document.getElementById('save-msg').classList.remove('hidden'); document.getElementById('save-lvl').innerText = d.lvl + 1; this.upgrades = d.upgrades || {}; } } catch(e){} },
    show(id) { document.querySelectorAll('.scene').forEach(el=>el.classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); document.getElementById('modal-msg').classList.add('hidden'); },
    toMenu() { this.checkSave(); this.show('scene-menu'); const a = document.getElementById('bgm-player'); if(a.src.includes('battle')||a.paused){a.src='bgm.mp3';a.play().catch(()=>{});} },
    toModes() { this.show('scene-modes'); },
    toLevels() {
        let maxLvl = 0; try { const s = localStorage.getItem('shanhai_v7'); if(s) maxLvl = JSON.parse(s).lvl; } catch(e) {}
        const grid = document.getElementById('level-grid'); grid.innerHTML = '';
        LEVELS.forEach((l, i) => {
            if (i <= maxLvl) grid.innerHTML += `<div class="level-btn" onclick="Game.startRun(${i})">ç¬¬ ${i+1} å±‚ï¼š${l.n}<div>HP: ${l.hp} / ATK: ${l.atk}</div></div>`;
            else grid.innerHTML += `<div class="level-btn" style="opacity:0.3; pointer-events:none; filter:grayscale(1); border-color:#333;">ç¬¬ ${i+1} å±‚ï¼š???<div>ğŸ”’ éœ€é€šå…³å‰ç½®è¯•ç‚¼</div></div>`;
        });
        this.show('scene-levels');
    },
    loadRun() { try { const s = localStorage.getItem('shanhai_v7'); if(s) { const d = JSON.parse(s); this.lvl=d.lvl; this.deck=d.deckIds; this.upgrades=d.upgrades||{}; this.hand = d.handData.map(h => { const def = CARDS.find(c=>c.id===h.id); return { def:def, mp:h.mp, lv:h.lv, xp:h.xp, el:null }; }); this.p=d.p; this.initBattle(true); } else this.newGame(); } catch(e) { this.newGame(); } },
    newGame() { this.lvl=0; this.upgrades={}; this.toDeck(); },
    save() { const hd = this.hand.map(c=>({id:c.def.id, mp:c.mp, lv:c.lv, xp:c.xp})); localStorage.setItem('shanhai_v7', JSON.stringify({lvl:this.lvl, deckIds:this.deck, handData:hd, p:this.p, upgrades:this.upgrades})); },

    toDeck() { 
        this.deck = []; const c = document.getElementById('grid-container'); c.innerHTML = ''; 
        CARDS.forEach(card => {
            const el = document.createElement('div'); el.className = 'card-box'; el.style.borderColor = card.color;
            el.onclick = () => this.pick(card.id, el);
            el.innerHTML = `<div class="role-badge ${card.type==='atk'?'bg-red':(card.type==='def'?'bg-blue':'bg-purple')}">${card.role}</div><div class="c-img" style="flex:1; display:flex; align-items:center; justify-content:center; overflow:hidden;"><img src="images/card_${card.id}_human.png" style="width:100%; height:100%; object-fit:cover;"></div><div class="card-name-mask"><div class="card-name-text" style="color:${card.color}; font-size:26px; font-weight:bold; transition:0.3s;">${card.name}</div></div>`;
            c.appendChild(el);
        });
        this.updateBtn(); this.show('scene-deck'); 
    },
    pick(id, el) { const idx=this.deck.indexOf(id); if(idx>-1) { this.deck.splice(idx,1); el.classList.remove('picked'); } else { if(this.deck.length>=3)return; this.deck.push(id); this.playVoice(id,'pick'); el.classList.add('picked'); } this.updateBtn(); },
    updateBtn() { const b=document.getElementById('btn-deploy'); const n=this.deck.length; b.innerText=`å‡ºå¾ (${n}/3)`; b.removeAttribute('disabled'); b.style.opacity=n===3?'1':'0.4'; b.style.cursor=n===3?'pointer':'not-allowed'; },
    
    startRun(customLvl = 0) { 
        if(this.deck.length!==3) return; if (!this.upgrades) this.upgrades = {};
        this.sp = 3; this.round = 1; 
        this.hand = this.deck.map(id => { const def = CARDS.find(c=>c.id===id); if(!def) return null; const up = this.upgrades[id] || {mp:0, hp:0, atk:0}; return { def:def, mp:50+up.mp, lv:1, xp:0, el:null }; }).filter(c => c !== null); 
        this.lvl = customLvl; this.initBattle(); this.updateSP();
    },

    initBattle(isLoad=false) {
        const aud=document.getElementById('bgm-player'); if(!aud.src.includes('battle_bgm.mp3')){aud.src='battle_bgm.mp3';aud.play().catch(()=>{});}
        if(this.lvl >= LEVELS.length) { this.modal("é€šå…³ï¼", "æ­å–œé€šè¿‡æ‰€æœ‰è¯•ç‚¼ï¼", [{t:"å›ä¸»é¡µ", f:()=>this.toMenu()}]); return; }
        
        const boss = LEVELS[this.lvl];
        this.e = { hp:boss.hp, max:boss.hp, dot:0, stun:false, debuffs:[], saidHalf:false };
        
        if(!isLoad) { 
            this.p = { hp:0, max:4000 + (this.lvl*500), shield:0, buffs:[] }; 
            this.hand.forEach(c => { const up = this.upgrades[c.def.id]; if(up) this.p.max += up.hp; });
            this.p.hp = this.p.max;
        }
        
        this.turnLocked=false; 
        this.currentActor = 0;

        document.getElementById('ui-lvl').innerText = this.lvl + 1;
        document.getElementById('name-e').innerText = boss.n;
        document.getElementById('img-e').src = boss.img;
        document.getElementById('log-content').innerHTML = "<div class='log-s'>æˆ˜æ–—å¼€å§‹ï¼</div>";

        if(!isLoad) {
            if(boss.voice && boss.voice.start) setTimeout(()=>this.playVoice('boss', null, boss.voice.start), 500);
            if(boss.lines && boss.lines.start) setTimeout(()=>{ this.spawnBanner('u-enemy', boss.lines.start); this.log(`${boss.n}: "${boss.lines.start}"`, 'log-e'); }, 500);
        }

        const hz = document.getElementById('hand-zone'); hz.innerHTML='';
        this.hand.forEach((obj, idx) => {
            const el = document.createElement('div'); el.className='card'; el.style.borderColor=obj.def.color; 
            el.onclick = () => this.toggleMenu(idx);
            let btns=""; 
            obj.def.skills.forEach((s,si)=>{
                const isUlt=s.c>=100; const cost=s.c>0?`-${s.c}`:`+${s.gain||25}`;
                btns+=`<div class="s-btn ${isUlt?'ult':''}" id="b-${idx}-${si}" onclick="window.Game.use(event,${idx},${si})"><div>${s.n}</div><div>${cost}</div><div class="tooltip">${s.d}</div></div>`;
            });
            const forms = ['beast', 'q', 'human']; 
            const formIdx = Math.min(2, Math.max(0, (obj.lv || 1) - 1));
            const imgPath = `images/card_${obj.def.id}_${forms[formIdx]}.png`;
            el.innerHTML = `<div class="card-level">Lv.${obj.lv}</div><div class="c-img"><img id="ci-${idx}" src="${imgPath}"></div><div class="card-mask"><div style="color:${obj.def.color};font-size:20px;font-weight:bold;text-align:center;">${obj.def.name}</div><div class="mp-bar"><div class="mp-val" id="mp-${idx}" style="width:${obj.mp}%"></div></div><div class="xp-bar"><div class="xp-val" id="xp-${idx}" style="width:0%"></div></div></div><div class="skill-menu" id="sm-${idx}">${btns}</div>`;
            hz.appendChild(el); obj.el=el;
        });

        this.updateActionBar();
        this.updateTurnState(); 
        this.updateUI(); 
        this.show('scene-battle');
        this.save();
    },

    updateTurnState() {
        this.hand.forEach((c, i) => {
            if (!c.el) return;
            c.el.classList.remove('my-turn');
            c.el.classList.remove('active'); 
            if (i === this.currentActor && this.currentActor < 3) {
                c.el.classList.add('my-turn'); 
            }
        });
        if (this.currentActor < 3) {
            this.highlightAction('player', this.currentActor);
        } else {
            this.highlightAction('boss', 0);
        }
    },

    updateActionBar() {
        const c = document.getElementById('action-bar-container'); if(!c) return;
        c.innerHTML = '';
        this.hand.forEach((h, idx) => {
            if (!h) return;
            const div = document.createElement('div');
            const isActed = idx < this.currentActor;
            div.className = `ab-node ${isActed ? 'acted' : ''}`; 
            div.id = `ab-p-${idx}`;
            const forms = ['beast', 'q', 'human'];
            const currentForm = forms[(h.lv||1) - 1] || 'beast';
            div.innerHTML = `<img src="images/card_${h.def.id}_${currentForm}.png">`;
            c.appendChild(div);
        });
        if (this.e.hp > 0) {
            const bossDiv = document.createElement('div'); bossDiv.className = 'ab-node'; bossDiv.id = `ab-boss`; bossDiv.style.borderColor = '#ff0000';
            bossDiv.innerHTML = `<img src="${LEVELS[this.lvl].img}">`; c.appendChild(bossDiv);
        }
    },
    highlightAction(who, idx) {
        document.querySelectorAll('.ab-node').forEach(el => el.classList.remove('active'));
        const id = who === 'player' ? `ab-p-${idx}` : `ab-boss`;
        const el = document.getElementById(id); if(el) el.classList.add('active');
    },

    toggleMenu(idx) {
        if (this.turnLocked) return;
        if (idx !== this.currentActor) return;
        const targetCard = this.hand[idx];
        const isAlreadyActive = targetCard.el.classList.contains('active');
        this.hand.forEach(c => c.el.classList.remove('active'));
        if (!isAlreadyActive) {
            targetCard.el.classList.add('active');
            this.playVoice(targetCard.def.id, 'pick'); 
        }
    },

    use(e, hIdx, sIdx) {
        e.stopPropagation();
        if(this.turnLocked) return;
        if (hIdx !== this.currentActor) { this.log("âš ï¸ è¿˜æ²¡è½®åˆ°ä»–è¡ŒåŠ¨ï¼", "gray"); return; }

        const card = this.hand[hIdx];
        const skill = card.def.skills[sIdx];
        const isUlt = skill.c >= 100; 

        if (isUlt) { if (card.mp < skill.c) { this.log("èƒ½é‡ä¸è¶³ï¼", "gray"); this.shakeScreen(); return; } } 
        else { if (sIdx === 1 && this.sp < 1) { this.log("æˆ˜æŠ€ç‚¹ä¸è¶³ï¼", "red"); this.shakeScreen(); return; } }

        this.turnLocked = true; 
        
        if (isUlt) { 
            card.mp -= skill.c; 
            VFX.ultScreen(card.def.color); 
        } else {
            if (sIdx === 0 && this.sp < this.maxSp) { this.sp++; }
            if (sIdx === 1) this.sp--; 
            card.mp = Math.min(100, card.mp + (skill.gain || 20));
        }
        
        this.updateSP();
        this.playVoice(card.def.id, isUlt?'ult':(sIdx===1?'s2':'s1'));
        this.spawnBanner('u-player', `[${card.def.name}] ${skill.n}`);
        this.log(`ã€${card.def.name}ã€‘é‡Šæ”¾ ${skill.n}`, 'log-p');
        card.el.classList.remove('active');
        if (!isUlt) { this.currentActor++; }
        this.updateActionBar();

        const playerEl = document.getElementById('u-player');
        const bossEl = document.getElementById('u-enemy');

        // === æé€Ÿå“åº”ï¼š250msåé£˜å­— ===
        setTimeout(() => {
            let xp = (skill.xp||20); 
            this.gainXp(card, xp, hIdx);
            
            let mult = card.lv; 
            const up = this.upgrades[card.def.id];
            if(up && up.atk) mult += (up.atk/100); 

            if(skill.val && !skill.heal) {
                 let v = Math.floor(skill.val * 200 * mult); 
                 let isCrit = false;
                 if (this.e.debuffs.includes('vuln') || Math.random() < 0.15) { // æé«˜æš´å‡»ç‡åˆ°15%
                     isCrit = true;
                     v = Math.floor(v * 1.5);
                 }
                 if (isUlt && card.role === "æ¯ç­") isCrit = true;
                 if(this.e.debuffs.includes('vuln')) v = Math.floor(v * 1.5);
                 if(this.e.debuffs.includes('vuln_huge')) v = Math.floor(v * 2.0);

                 this.e.hp = Math.max(0, this.e.hp - v);
                 
                 VFX.impact(bossEl, skill.vfx || 'fox-1', card.def.color);
                 if(isCrit) this.shakeScreen();
                 VFX.floatNum(bossEl, v, isCrit ? 'crit' : 'normal'); 
            }

            if(skill.heal) {
                let v = Math.floor(skill.heal * mult);
                this.p.hp = Math.min(this.p.max, this.p.hp+v);
                VFX.floatNum(playerEl, v, 'heal');
                VFX.impact(playerEl, skill.vfx, '#0f0');
            }
            if(skill.self) {
                 this.p.hp = Math.max(1, this.p.hp - skill.self);
                 VFX.floatNum(playerEl, `-${skill.self}`, 'normal');
            }

            if(skill.shield) this.p.shield += Math.floor(skill.shield * mult * 1.5);
            if(skill.buff) { this.addBuff(skill.buff); VFX.impact(playerEl, skill.vfx, '#fff'); }
            if(skill.debuff) this.addDebuff(skill.debuff);
            if(skill.stun) { this.e.stun = true; VFX.floatNum(bossEl, "çœ©æ™•", "crit"); }
            if(skill.mp_up) this.hand.forEach(c=>c.mp=Math.min(100,c.mp+25));
            if(skill.mp_all) this.hand.forEach(c=>c.mp=100);

            this.updateUI();

            if(this.e.hp<=0) {
                const boss = LEVELS[this.lvl];
                if(boss.voice && boss.voice.dead) this.playVoice('boss', null, boss.voice.dead);
                if(boss.lines && boss.lines.dead) { this.spawnBanner('u-enemy', boss.lines.dead); this.log(`${boss.n}: "${boss.lines.dead}"`, 'log-e'); }
                setTimeout(()=>this.win(), 1500);
            } else if (isUlt) {
                this.turnLocked = false;
                this.updateTurnState(); 
            } else {
                this.turnLocked = false;
                if (this.currentActor >= 3) {
                    this.updateTurnState(); 
                    setTimeout(() => this.enemyTurn(), 800);
                } else {
                    this.updateTurnState(); 
                }
            }
        }, 250); 
    },

    // === BOSS å›åˆä¿®æ”¹ï¼šå•æ¬¡è¡ŒåŠ¨æ¨¡å¼ ===
    async enemyTurn() {
        this.turnLocked = true;
        this.highlightAction('boss', 0); 
        this.log("ã€æ•Œæ–¹å›åˆã€‘", "log-e");

        const boss = LEVELS[this.lvl];

        // çœ©æ™•åˆ¤å®š
        if(this.e.stun) { 
            this.e.stun=false; 
            this.log("ğŸš« BOSS å¤„äºçœ©æ™•çŠ¶æ€ï¼Œè·³è¿‡è¡ŒåŠ¨ï¼", "log-s"); 
            VFX.floatNum(document.getElementById('u-enemy'), "çœ©æ™•è·³è¿‡", "crit");
            // çœ©æ™•åç›´æ¥ç»“æŸå›åˆ
            setTimeout(() => this.endRound(), 1000);
            return; 
        }

        // DOTç»“ç®—
        if(this.e.dot>0) {
             this.e.hp = Math.max(0, this.e.hp - this.e.dot);
             VFX.floatNum(document.getElementById('u-enemy'), this.e.dot, "normal");
             if(this.e.hp<=0) { this.checkEnd(); return; }
        }
        
        // æŠ€èƒ½é€‰æ‹©ç®—æ³• (åŠ æƒéšæœº)
        let move = boss.moves[0];
        let moveIdx = 0;
        const r = Math.random() * 100;
        let acc = 0;
        for(let i=0; i<boss.moves.length; i++) { 
            acc += boss.moves[i].p; 
            if(r <= acc) { move = boss.moves[i]; moveIdx = i; break; } 
        }

        const voiceFile = `boss_${this.lvl + 1}_move_${moveIdx + 1}.wav`;
        this.playVoice('boss', null, voiceFile);

        this.spawnBanner('u-enemy', `âš ï¸ ${move.n}`);
        this.log(`ğŸ”´ ${boss.n} é‡Šæ”¾ï¼š${move.txt}`, 'log-e');
        
        try { VFX.impact(document.getElementById('u-player'), move.type || 'tao-1'); } catch(e){}

        if(move.val > 0) {
            let dmg = Math.floor(boss.atk * move.val);
            if(this.p.buffs.includes('vuln')) dmg = Math.floor(dmg * 1.5);
            
            if(this.p.shield > 0) { 
                if(this.p.shield >= dmg) { 
                    this.p.shield -= dmg; 
                    dmg = 0; 
                    VFX.floatNum(document.getElementById('u-player'), "æ ¼æŒ¡", "normal"); 
                } else { 
                    dmg -= this.p.shield; 
                    this.p.shield = 0; 
                }
            }
            
            if(dmg > 0) {
                this.p.hp = Math.max(0, this.p.hp - dmg);
                this.shakeScreen();
                VFX.floatNum(document.getElementById('u-player'), dmg, "crit"); 
            }
        }
        if(move.heal) { 
            this.e.hp = Math.min(boss.hp, this.e.hp + move.heal); 
            VFX.floatNum(document.getElementById('u-enemy'), move.heal, "heal");
        }
        if(move.debuff) this.addDebuff(move.debuff);
        this.updateUI();

        if(this.checkEnd()) return;
        
        // ğŸ”´ å…³é”®ä¿®æ”¹ï¼šåªè¡ŒåŠ¨ä¸€æ¬¡ï¼Œç„¶åç›´æ¥ç»“æŸå›åˆ
        setTimeout(() => this.endRound(), 1200); 
    },

    // å›åˆç»“æŸå¤„ç†
    endRound() {
        this.round++;
        this.currentActor = 0; 
        this.log(`=== ç¬¬ ${this.round} å›åˆ ===`, "log-s");
        this.hand.forEach(c => c.acted = false);
        this.updateActionBar();
        this.updateTurnState(); 
        this.turnLocked = false; 
    },

    checkHalfHealth() {
        const boss = LEVELS[this.lvl];
        if (!this.e.saidHalf && this.e.hp < (boss.hp * 0.5)) {
            this.e.saidHalf = true;
            if (boss.voice && boss.voice.half) this.playVoice('boss', null, boss.voice.half);
            if (boss.lines && boss.lines.half) {
                this.spawnBanner('u-enemy', "HP < 50%");
                this.log(`BOSS æ€’å¼: "${boss.lines.half}"`, '#ff8800');
            }
        }
    },

    checkEnd() {
        if(this.e.hp<=0) { setTimeout(()=>this.win(), 1000); return true; }
        if(this.p.hp<=0) { setTimeout(()=>this.lose(), 1000); return true; }
        return false;
    },

    gainXp(c, val, idx) {
        if(c.lv>=3) return;
        c.xp += val; 
        const maxXp = XP_MAX[c.lv-1];

        if(c.xp >= maxXp) { 
            c.xp = 0; 
            c.lv++; 
            const cardImg = document.getElementById(`ci-${idx}`);
            const cardEl = c.el;
            const forms = ['beast', 'q', 'human']; 
            const nextSrc = `images/card_${c.def.id}_${forms[c.lv-1]}.png`;
            cardEl.classList.add('card-evolving');
            const beam = document.createElement('div'); beam.className = 'evolve-beam'; cardEl.appendChild(beam);
            setTimeout(() => {
                 cardImg.src = nextSrc;
                 this.updateActionBar(); 
                 const txt = document.createElement('div'); txt.className = 'evo-text'; txt.innerText = "âœ¦ è¿› åŒ– âœ¦"; cardEl.appendChild(txt);
                 setTimeout(()=>txt.remove(), 1000);
                 this.p.hp = Math.min(this.p.max, this.p.hp + 2000); 
                 VFX.floatNum(cardEl, "èƒ½åŠ›è§‰é†’!", "crit");
            }, 750); 
            setTimeout(() => { cardEl.classList.remove('card-evolving'); beam.remove(); }, 1500);
        }
    },
    updateSP() {
        const c = document.getElementById('sp-bar-container'); if(!c) return;
        let h = `<div style="color:#fff; font-size:20px; margin-right:10px; text-shadow:0 0 5px #000;">æˆ˜æŠ€ç‚¹:</div>`;
        for(let i=0; i<this.maxSp; i++) h += `<div class="sp-dot ${i < this.sp ? 'active' : ''}"></div>`;
        c.innerHTML = h;
    },
    updateUI() {
        this.checkHalfHealth();
        const ePct = (this.e.hp / this.e.max) * 100;
        const barE = document.getElementById('bar-e'); if(barE) barE.style.width = `${Math.max(0, ePct)}%`;
        const txtE = document.getElementById('hp-txt-e'); if(txtE) txtE.innerText = `${Math.floor(this.e.hp)} / ${this.e.max}`;
        const pPct = (this.p.hp / this.p.max) * 100;
        const barP = document.getElementById('bar-p'); if(barP) barP.style.width = `${Math.max(0, pPct)}%`;
        const txtP = document.getElementById('hp-txt-p'); if(txtP) { txtP.innerText = `${Math.floor(this.p.hp)} / ${this.p.max}`; if(this.p.shield > 0) txtP.innerText += ` [ç›¾:${Math.floor(this.p.shield)}]`; }
        const buffP = document.getElementById('buff-p'); if(buffP) buffP.innerHTML = this.p.buffs.map(b => `<div class="buff" style="color:#aaf;border-color:#aaf">${b}</div>`).join('');
        const buffE = document.getElementById('buff-e'); if(buffE) buffE.innerHTML = this.e.debuffs.map(b => `<div class="buff" style="color:#f55;border-color:#f55">${b}</div>`).join('');
        if(this.hand) {
            this.hand.forEach((c, i) => {
                if(!c) return;
                const mpBar = document.getElementById(`mp-${i}`); if(mpBar) mpBar.style.width = `${c.mp}%`;
                const xpBar = document.getElementById(`xp-${i}`); const maxXp = XP_MAX[c.lv - 1] || 9999; if(xpBar) xpBar.style.width = `${Math.min(100, (c.xp / maxXp) * 100)}%`;
                c.def.skills.forEach((s, si) => {
                    const btn = document.getElementById(`b-${i}-${si}`);
                    if(btn) {
                        btn.classList.remove('disabled');
                        if(s.c > 0 && c.mp < s.c) btn.classList.add('disabled');
                        if(si === 1 && this.sp < 1) btn.classList.add('disabled');
                    }
                });
            });
        }
    },
    modal(title, desc, btns) { const m = document.getElementById('modal-msg'); document.getElementById('msg-t').innerText = title; document.getElementById('msg-d').innerText = desc; const bDiv = document.getElementById('msg-b'); bDiv.innerHTML = ''; btns.forEach(b => { const btn = document.createElement('button'); btn.className = 'btn'; btn.innerText = b.t; btn.onclick = () => { m.classList.add('hidden'); if (b.f) b.f(); }; bDiv.appendChild(btn); }); m.classList.remove('hidden'); },
    win() { this.lvl++; this.save(); this.showReward(); },
    showReward() { const grid = document.getElementById('reward-grid'); grid.innerHTML = ''; this.hand.forEach(c => { const el = document.createElement('div'); el.className = 'card-box'; el.style.height = 'auto'; el.style.padding = '20px'; el.style.borderColor = c.def.color; const up = this.upgrades[c.def.id] || {hp:0, atk:0, mp:0}; el.innerHTML = `<div class="c-img" style="height:200px"><img src="images/card_${c.def.id}_human.png"></div><h3 style="color:${c.def.color};text-align:center;">${c.def.name}</h3><div style="font-size:14px; color:#aaa; margin-bottom:10px;">å½“å‰åŠ æˆ:<br> HP+${up.hp} | æ”»+${up.atk}% | çµ+${up.mp}</div><button class="btn" style="font-size:16px; padding:5px; margin-bottom:5px; min-width:auto; width:100%" onclick="Game.applyReward(${c.def.id}, 'hp')">â¤ï¸ ç”Ÿå‘½ä¸Šé™ +500</button><button class="btn" style="font-size:16px; padding:5px; margin-bottom:5px; min-width:auto; width:100%" onclick="Game.applyReward(${c.def.id}, 'atk')">âš”ï¸ ä¼¤å®³ +15%</button><button class="btn" style="font-size:16px; padding:5px; margin-bottom:5px; min-width:auto; width:100%" onclick="Game.applyReward(${c.def.id}, 'mp')">ğŸ’§ åˆå§‹çµåŠ› +30</button>`; grid.appendChild(el); }); this.show('scene-reward'); },
    applyReward(cardId, type) { if(!this.upgrades[cardId]) this.upgrades[cardId] = {hp:0, atk:0, mp:0}; if(type === 'hp') this.upgrades[cardId].hp += 500; else if(type === 'atk') this.upgrades[cardId].atk += 15; else if(type === 'mp') this.upgrades[cardId].mp += 30; this.save(); this.initBattle(); },
    addBuff(b){ if(!this.p.buffs.includes(b))this.p.buffs.push(b); },
    addDebuff(b){ if(!this.e.debuffs.includes(b))this.e.debuffs.push(b); },
    spawnBanner(id, t) { const u=document.getElementById(id==='u-player'?'banner-player':'banner-enemy'); u.innerText=t; u.classList.remove('banner-anim'); void u.offsetWidth; u.classList.add('banner-anim'); },
    lose() { this.modal("å¤±è´¥...", "èƒœè´¥ä¹ƒå…µå®¶å¸¸äº‹ã€‚", [{t:"è¿”å›ä¸»é¡µ", f:()=>this.toMenu()}]); },
    toGallery() { const g = document.getElementById('gallery-grid'); g.innerHTML = ''; CARDS.forEach(c => { const el = document.createElement('div'); el.className = 'card-box'; el.style.borderColor = c.color; el.onclick = () => { this.playVoice(c.id, 'idle'); this.openDetail(c); }; el.innerHTML = `<div class="c-img" style="flex:1; display:flex; align-items:center; justify-content:center; overflow:hidden;"><img src="images/card_${c.id}_human.png" style="width:100%; height:100%; object-fit:cover;"></div><div class="card-name-mask"><div class="card-name-text" style="color:${c.color}; font-size:24px; font-weight:bold;">${c.name}</div></div>`; g.appendChild(el); }); this.show('scene-gallery'); },
    toStory() { const l = document.getElementById('story-list'); l.innerHTML = ''; CARDS.forEach(c => { const el = document.createElement('div'); el.className = 'card-box'; el.style.borderColor = c.color; el.onclick = () => this.openStory(c); el.innerHTML = `<div class="c-img" style="flex:1; display:flex; align-items:center; justify-content:center; overflow:hidden;"><img src="images/card_${c.id}_human.png" style="width:100%; height:100%; object-fit:cover;"></div><div class="card-name-mask"><div class="card-name-text" style="color:${c.color}; font-size:24px; font-weight:bold;">${c.name}</div></div>`; l.appendChild(el); }); this.show('scene-story'); },
    openDetail(c) { 
        this.viewCard = c; 
        document.getElementById('modal-detail').classList.remove('hidden'); 
        
        // å¡«å……åå­—å’Œæè¿°
        document.getElementById('dv-name').innerText = c.name; 
        document.getElementById('dv-name').style.color = c.color; 
        document.getElementById('dv-role').innerText = `ã€${c.role}ã€‘ ${c.desc}`; 
        document.getElementById('dv-role').style.color = c.color; 
        document.getElementById('dv-desc').innerHTML = c.story ? c.story.bg : "ä¸Šå¤ç¥å…½ï¼Œæ‹¥æœ‰ä¸å¯æ€è®®çš„åŠ›é‡ã€‚"; 
        
        // å¡«å……æŠ€èƒ½åˆ—è¡¨
        const ds = document.getElementById('dv-skills'); 
        ds.innerHTML = ''; 
        c.skills.forEach(s => {
            ds.innerHTML += `
            <div style="margin-bottom:12px; border-bottom:1px dashed rgba(255,255,255,0.1); padding-bottom:8px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
                    <span style="color:${c.color}; font-size:18px; font-weight:bold;">${s.n}</span>
                    <span style="color:#888; font-size:13px; background:rgba(0,0,0,0.3); padding:2px 6px; border-radius:4px;">
                        ${s.c > 0 ? 'æ¶ˆè€— ' + s.c : 'å›å¤ 20'}
                    </span>
                </div>
                <div style="color:#ccc; font-size:15px;">${s.d}</div>
            </div>`;
        }); 
        
        // é»˜è®¤å…ˆå±•ç¤ºæ‹Ÿäººå½¢æ€ (Human)
        this.setDvForm('human'); 
    }, 
    
    setDvForm(f) { 
        // è¿™é‡Œçš„ f åº”è¯¥æ˜¯ 'beast', 'q', æˆ– 'human'
        if (!this.viewCard) return;
        const img = document.getElementById('dv-img');
        // æ·»åŠ ä¸€ä¸ªæ·¡å…¥æ·¡å‡ºçš„å°åŠ¨ç”»æ•ˆæœ
        img.style.opacity = 0;
        setTimeout(() => {
            img.src = `images/card_${this.viewCard.id}_${f}.png`;
            // å¦‚æœå›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºå ä½ç¬¦
            img.onerror = () => { img.src = '//via.placeholder.com/400x600?text=No+Image'; };
            img.onload = () => { img.style.opacity = 1; };
        }, 100);
    },
    openStory(c) { document.getElementById('modal-story').classList.remove('hidden'); document.getElementById('sv-img').src=`images/card_${c.id}_human.png`; document.getElementById('sv-name').innerText=c.name; document.getElementById('sv-name').style.color=c.color; const ct=document.getElementById('sv-content'); const s=c.story||{}; let h = `<div class="story-title">ğŸ“œ ç”Ÿå¹³ ${this.mkV(s.voice?.bio,c.id,'bio')}</div><div class="story-text">${s.bio}</div>`; h += `<div class="story-title">ğŸŒŒ èƒŒæ™¯ ${this.mkV(s.voice?.bg,c.id,'bg')}</div><div class="story-text">${s.bg}</div>`; h += `<div class="story-title">ğŸ‘ï¸ ç¾ç»Šä¸å°è±¡</div><div class="relation-grid">`; CARDS.forEach(o=>{ if(o.id===c.id) return; const imp = (s.impressions && s.impressions[o.id]) ? s.impressions[o.id] : null; if(imp) { h+=`<div class="relation-card" style="cursor:default"><div class="rc-avatar" style="border-color:${o.color}"><img src="images/card_${o.id}_human.png"></div><div class="rc-content"><div style="font-size:16px; color:${o.color}; font-weight:bold; margin-bottom:5px;">To ${o.name}</div><div class="rc-label"><span style="color:#fff">ã€åˆè¯†ã€‘</span>${imp.v_meet ? `<div class="audio-btn" onclick="event.stopPropagation(); Game.playVoice(null,null,'${imp.v_meet}')">ğŸ”Š æ’­æ”¾</div>` : ''}</div><div class="rc-text" style="margin-bottom:8px;">${imp.meet}</div><div class="rc-section"><div class="rc-label"><span style="color:#fff">ã€å°è±¡ã€‘</span>${imp.v_imp ? `<div class="audio-btn" onclick="event.stopPropagation(); Game.playVoice(null,null,'${imp.v_imp}')">ğŸ”Š æ’­æ”¾</div>` : ''}</div><div class="rc-text">${imp.imp}</div></div></div></div>`; } }); h+=`</div>`; ct.innerHTML=h; },
    mkV(f,id,t) { if(!f) return ''; return `<span class="voice-icon" onclick="event.stopPropagation(); Game.playVoice(null,null,'${f}')">ğŸ”Š</span>`; },
    openBookMode() { var src = document.getElementById('sv-content'); var tgt = document.getElementById('book-content'); var overlay = document.getElementById('book-overlay'); if(src && tgt) { tgt.innerHTML = src.innerHTML; overlay.classList.add('active'); } },
    closeBookMode() { var overlay = document.getElementById('book-overlay'); if(overlay) { overlay.classList.remove('active'); } },
    log(t,c) { 
        const d = document.getElementById('log-content'); 
        d.innerHTML += `<div class="log-item" style="color:${c}">${t}</div>`; 
        d.scrollTop = d.scrollHeight; 
    },
    pause() { this.turnLocked = true; this.modal("æš‚åœ", "æ¸¸æˆå·²æš‚åœ", [{t: "ç»§ç»­", f: () => { this.turnLocked = false; }}, {t: "é€€å‡ºæˆ˜æ–—", f: () => { this.toMenu(); }}]); }
};

function setMusicVol(v){ const a=document.getElementById('bgm-player'); a.volume=v; if(v>0&&a.paused)a.play().catch(()=>{}); }
function setVoiceVol(v){ Game.voiceVol=v; if(Game.currentVoice)Game.currentVoice.volume=v; }
window.addEventListener('click', e=>{ if(e.target.closest('.btn')||e.target.closest('.s-btn')||e.target.closest('.card-box')){ const s=document.getElementById('se-click'); if(s){s.currentTime=0;s.play().catch(()=>{});} } });
Game.init(); Game.toMenu();
</script>
</body>
</html>